<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üìö Poetry Analyzer - AI Í∏∞Î∞ò Ïãú Î∂ÑÏÑù ÎèÑÍµ¨</title>
    <meta name="description" content="AIÎ•º ÌôúÏö©Ìïú ÏòÅÏñ¥ Ïãú Î∂ÑÏÑù ÎèÑÍµ¨. ÏàòÏÇ¨Î≤ï, Ïö¥Ïú®, Ï£ºÏ†ú Îì±ÏùÑ ÏûêÎèôÏúºÎ°ú Î∂ÑÏÑùÌïòÏó¨ ÍµêÏú° ÏûêÎ£åÎ•º ÏÉùÏÑ±Ìï©ÎãàÎã§.">
    <meta name="keywords" content="poetry analysis, AI, literature, education, Ïãú Î∂ÑÏÑù, Î¨∏Ìïô Î∂ÑÏÑù">
    
    <!-- Open Graph Meta Tags -->
    <meta property="og:title" content="Poetry Analyzer - AI Í∏∞Î∞ò Ïãú Î∂ÑÏÑù ÎèÑÍµ¨">
    <meta property="og:description" content="ÏòÅÏñ¥ ÏãúÎ•º AIÎ°ú Î∂ÑÏÑùÌïòÏó¨ ÏàòÏÇ¨Î≤ï, Ïö¥Ïú®, Ï£ºÏ†ú Îì±ÏùÑ ÏûêÎèôÏúºÎ°ú Ï∞æÏïÑÏ£ºÎäî ÍµêÏú°Ïö© ÎèÑÍµ¨">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://yourusername.github.io/poetry-analyzer">
    
    <!-- Favicon -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üìö</text></svg>">
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
            padding: 40px 20px;
        }
        
        .header h1 {
            font-size: 3em;
            margin-bottom: 15px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
            animation: fadeInDown 1s ease-out;
        }
        
        .header p {
            font-size: 1.3em;
            opacity: 0.9;
            animation: fadeInUp 1s ease-out 0.3s both;
        }
        
        .main-content {
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 15px 35px rgba(0,0,0,0.2);
            margin-bottom: 30px;
            animation: fadeIn 1s ease-out 0.6s both;
        }
        
        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }
        
        .feature-card {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            padding: 25px;
            border-radius: 15px;
            text-align: center;
            transition: transform 0.3s, box-shadow 0.3s;
            cursor: pointer;
        }
        
        .feature-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.2);
        }
        
        .feature-icon {
            font-size: 3em;
            margin-bottom: 15px;
            display: block;
        }
        
        .feature-title {
            font-size: 1.2em;
            font-weight: bold;
            margin-bottom: 10px;
        }
        
        .feature-desc {
            font-size: 0.9em;
            opacity: 0.9;
        }
        
        .input-section {
            margin-bottom: 30px;
        }
        
        .input-section h2 {
            color: #4a5568;
            margin-bottom: 20px;
            font-size: 1.8em;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .form-group {
            margin-bottom: 25px;
        }
        
        .form-group label {
            display: block;
            font-weight: 600;
            color: #495057;
            margin-bottom: 10px;
            font-size: 1.1em;
        }
        
        .form-group input,
        .form-group textarea {
            width: 100%;
            padding: 15px;
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            font-size: 16px;
            transition: all 0.3s;
            font-family: inherit;
        }
        
        .form-group input:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
            transform: translateY(-2px);
        }
        
        #poemInput {
            min-height: 250px;
            font-family: 'Georgia', serif;
            line-height: 1.8;
            resize: vertical;
        }
        
        .char-count {
            text-align: right;
            color: #6c757d;
            font-size: 14px;
            margin-top: 8px;
        }
        
        .sample-section {
            margin-top: 25px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
            border: 1px solid #e9ecef;
        }
        
        .sample-section h3 {
            color: #495057;
            margin-bottom: 15px;
            font-size: 1.2em;
        }
        
        .sample-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
        
        .sample-btn {
            padding: 10px 18px;
            background: white;
            border: 2px solid #dee2e6;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s;
            color: #495057;
            font-weight: 500;
        }
        
        .sample-btn:hover {
            border-color: #667eea;
            background: #f0f4ff;
            transform: translateY(-2px);
        }
        
        .api-key-section {
            background: #fff3cd;
            border: 2px solid #ffeaa7;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 30px;
        }
        
        .api-key-section h3 {
            color: #856404;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .api-key-section p {
            color: #856404;
            margin-bottom: 15px;
            line-height: 1.6;
        }
        
        .api-key-section a {
            color: #0066cc;
            text-decoration: none;
            font-weight: 600;
        }
        
        .api-key-section a:hover {
            text-decoration: underline;
        }
        
        .btn {
            padding: 15px 30px;
            border: none;
            border-radius: 10px;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 10px;
            text-decoration: none;
            text-align: center;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
        }
        
        .btn-primary:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
        }
        
        .btn-secondary {
            background: #f8f9fa;
            color: #495057;
            border: 2px solid #e9ecef;
        }
        
        .btn-secondary:hover {
            background: #e9ecef;
            transform: translateY(-2px);
        }
        
        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none !important;
        }
        
        .button-group {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin: 30px 0;
            flex-wrap: wrap;
        }
        
        .loading {
            display: none;
            text-align: center;
            padding: 50px;
            color: #667eea;
        }
        
        .loading .spinner {
            width: 60px;
            height: 60px;
            border: 6px solid #e9ecef;
            border-top: 6px solid #667eea;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 25px;
        }
        
        .loading h3 {
            margin-bottom: 15px;
            font-size: 1.5em;
        }
        
        .loading p {
            font-size: 1.1em;
            opacity: 0.8;
        }
        
        .progress-bar {
            width: 100%;
            height: 10px;
            background: #e9ecef;
            border-radius: 5px;
            overflow: hidden;
            margin: 25px 0;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea, #764ba2);
            width: 0%;
            transition: width 0.5s ease;
            border-radius: 5px;
        }
        
        .error-message {
            background: #f8d7da;
            border: 2px solid #f5c6cb;
            color: #721c24;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            display: none;
        }
        
        .error-message h4 {
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .results {
            display: none;
            margin-top: 40px;
        }
        
        .results-header {
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
            color: white;
            padding: 30px;
            border-radius: 15px 15px 0 0;
            text-align: center;
        }
        
        .results-header h2 {
            margin-bottom: 15px;
            font-size: 2em;
        }
        
        .results-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .stat-card {
            background: rgba(255,255,255,0.2);
            padding: 15px;
            border-radius: 10px;
            text-align: center;
        }
        
        .stat-number {
            font-size: 2em;
            font-weight: bold;
            display: block;
            margin-bottom: 5px;
        }
        
        .stat-label {
            font-size: 0.9em;
            opacity: 0.9;
        }
        
        .results-content {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-top: none;
            border-radius: 0 0 15px 15px;
            padding: 40px;
        }
        
        .download-section {
            text-align: center;
            margin-bottom: 30px;
        }
        
        .download-section h3 {
            color: #495057;
            margin-bottom: 20px;
            font-size: 1.5em;
        }
        
        .preview-section {
            margin-top: 30px;
            padding: 25px;
            background: white;
            border-radius: 10px;
            border: 2px solid #e9ecef;
        }
        
        .preview-title {
            font-size: 1.3em;
            font-weight: bold;
            color: #495057;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .preview-content {
            max-height: 500px;
            overflow-y: auto;
            border: 1px solid #e9ecef;
            border-radius: 8px;
            padding: 20px;
            background: #fafafa;
            font-size: 0.95em;
            line-height: 1.6;
        }
        
        .footer {
            text-align: center;
            color: white;
            margin-top: 50px;
            padding: 30px;
            opacity: 0.9;
        }
        
        .footer p {
            margin-bottom: 10px;
        }
        
        .footer a {
            color: #ffd700;
            text-decoration: none;
        }
        
        .footer a:hover {
            text-decoration: underline;
        }
        
        /* Ïï†ÎãàÎ©îÏù¥ÏÖò */
        @keyframes fadeInDown {
            from {
                opacity: 0;
                transform: translateY(-30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        @keyframes fadeIn {
            from {
                opacity: 0;
            }
            to {
                opacity: 1;
            }
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* Î∞òÏùëÌòï ÎîîÏûêÏù∏ */
        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }
            
            .header h1 {
                font-size: 2.2em;
            }
            
            .header p {
                font-size: 1.1em;
            }
            
            .main-content {
                padding: 25px;
            }
            
            .feature-grid {
                grid-template-columns: 1fr;
            }
            
            .button-group {
                flex-direction: column;
                align-items: center;
            }
            
            .btn {
                width: 100%;
                max-width: 300px;
                justify-content: center;
            }
            
            .sample-buttons {
                flex-direction: column;
            }
            
            .sample-btn {
                text-align: center;
            }
        }
        
        /* Îã§ÌÅ¨ Î™®Îìú ÏßÄÏõê */
        @media (prefers-color-scheme: dark) {
            .main-content {
                background: #2d3748;
                color: #e2e8f0;
            }
            
            .form-group input,
            .form-group textarea {
                background: #4a5568;
                color: #e2e8f0;
                border-color: #718096;
            }
            
            .sample-section {
                background: #4a5568;
                border-color: #718096;
            }
            
            .sample-btn {
                background: #4a5568;
                color: #e2e8f0;
                border-color: #718096;
            }
            
            .preview-section {
                background: #4a5568;
                border-color: #718096;
            }
            
            .preview-content {
                background: #2d3748;
                color: #e2e8f0;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üìö Poetry Analyzer</h1>
            <p>AI Í∏∞Î∞ò ÏòÅÏñ¥ Ïãú Î∂ÑÏÑù ÎèÑÍµ¨ - ÏàòÏÇ¨Î≤ï, Ïö¥Ïú®, Ï£ºÏ†úÎ•º ÏûêÎèôÏúºÎ°ú Î∂ÑÏÑùÌï©ÎãàÎã§</p>
        </div>
        
        <div class="main-content">
            <!-- Ï£ºÏöî Í∏∞Îä• ÏÜåÍ∞ú -->
            <div class="feature-grid">
                <div class="feature-card">
                    <span class="feature-icon">üé≠</span>
                    <div class="feature-title">ÏàòÏÇ¨Î≤ï Î∂ÑÏÑù</div>
                    <div class="feature-desc">ÏùÄÏú†, ÏßÅÏú†, ÏùòÏù∏Î≤ï Îì± Îã§ÏñëÌïú ÏàòÏÇ¨Î≤ïÏùÑ ÏûêÎèôÏúºÎ°ú ÏãùÎ≥Ñ</div>
                </div>
                <div class="feature-card">
                    <span class="feature-icon">üéµ</span>
                    <div class="feature-title">Ïö¥Ïú® Î∂ÑÏÑù</div>
                    <div class="feature-desc">ÎëêÏö¥Î≤ï, Í∞ÅÏö¥Î≤ï, Î¶¨Îì¨ Ìå®ÌÑ¥ÏùÑ Ï†ïÎ∞ÄÌïòÍ≤å Î∂ÑÏÑù</div>
                </div>
                <div class="feature-card">
                    <span class="feature-icon">üîÆ</span>
                    <div class="feature-title">Ï£ºÏ†ú Î∂ÑÏÑù</div>
                    <div class="feature-desc">ÏãúÏùò Ï£ºÏ†ú, ÏÉÅÏßï, Î™®Ìã∞ÌîÑÎ•º ÍπäÏù¥ ÏûàÍ≤å Ìï¥ÏÑù</div>
                </div>
                <div class="feature-card">
                    <span class="feature-icon">üìÑ</span>
                    <div class="feature-title">HTML Î≥¥Í≥†ÏÑú</div>
                    <div class="feature-desc">ÏïÑÎ¶ÑÎã§Ïö¥ HTML ÌòïÌÉúÏùò Î∂ÑÏÑù Î≥¥Í≥†ÏÑú ÏûêÎèô ÏÉùÏÑ±</div>
                </div>
            </div>
            
            <!-- API ÌÇ§ ÏÑ§Ï†ï ÏïàÎÇ¥ -->
            <div class="api-key-section">
                <h3>üîë API ÌÇ§ ÏÑ§Ï†ï ÌïÑÏöî</h3>
                <p>Ïù¥ ÎèÑÍµ¨Îäî Google Gemini APIÎ•º ÏÇ¨Ïö©Ìï©ÎãàÎã§. Î¨¥Î£åÎ°ú ÏÇ¨Ïö©Ìï† Ïàò ÏûàÏúºÎ©∞, ÏïÑÎûò Îã®Í≥ÑÎ•º Îî∞Îùº API ÌÇ§Î•º ÏÑ§Ï†ïÌï¥Ï£ºÏÑ∏Ïöî:</p>
                <ol style="margin-left: 20px; margin-bottom: 15px;">
                    <li><a href="https://aistudio.google.com/app/apikey" target="_blank">Google AI Studio</a>ÏóêÏÑú Î¨¥Î£å API ÌÇ§ Î∞úÍ∏â</li>
                    <li>ÏïÑÎûò ÏûÖÎ†•ÎûÄÏóê API ÌÇ§Î•º ÏûÖÎ†•</li>
                    <li>API ÌÇ§Îäî Î∏åÎùºÏö∞Ï†ÄÏóêÎßå Ï†ÄÏû•ÎêòÎ©∞ Ïô∏Î∂ÄÎ°ú Ï†ÑÏÜ°ÎêòÏßÄ ÏïäÏäµÎãàÎã§</li>
                </ol>
            </div>
            
            <!-- API ÌÇ§ ÏûÖÎ†• -->
            <div class="form-group">
                <label for="apiKey">üîë Google Gemini API ÌÇ§</label>
                <input type="password" id="apiKey" placeholder="Ïó¨Í∏∞Ïóê API ÌÇ§Î•º ÏûÖÎ†•ÌïòÏÑ∏Ïöî (Ïòà: AIzaSy...)">
                <div class="char-count">API ÌÇ§Îäî Î°úÏª¨ÏóêÎßå Ï†ÄÏû•ÎêòÎ©∞ ÏïàÏ†ÑÌï©ÎãàÎã§</div>
            </div>
            
            <!-- Ïãú Ï†úÎ™© ÏûÖÎ†• -->
            <div class="input-section">
                <h2>üìù Ïãú Ï†ïÎ≥¥ ÏûÖÎ†•</h2>
                
                <div class="form-group">
                    <label for="poemTitle">Ïãú Ï†úÎ™© (ÏÑ†ÌÉùÏÇ¨Ìï≠)</label>
                    <input type="text" id="poemTitle" placeholder="Ïòà: The Road Not Taken by Robert Frost">
                </div>
                
                <!-- Ïãú ÏõêÎ¨∏ ÏûÖÎ†• -->
                <div class="form-group">
                    <label for="poemInput">Ïãú ÏõêÎ¨∏</label>
                    <textarea id="poemInput" placeholder="ÏòÅÏñ¥ ÏãúÏùò ÏõêÎ¨∏ÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî...

ÏòàÏãú:
Two roads diverged in a yellow wood,
And sorry I could not travel both
And be one traveler, long I stood
And looked down one as far as I could
To where it bent in the undergrowth;"></textarea>
                    <div class="char-count" id="charCount">0 Í∏ÄÏûê</div>
                </div>
                
                <!-- ÏÉòÌîå Ïãú -->
                <div class="sample-section">
                    <h3>üìñ Ïú†Î™ÖÌïú Ïãú ÏÉòÌîå</h3>
                    <div class="sample-buttons">
                        <button class="sample-btn" onclick="loadSample('frost')">Robert Frost - The Road Not Taken</button>
                        <button class="sample-btn" onclick="loadSample('shakespeare')">Shakespeare - Sonnet 18</button>
                        <button class="sample-btn" onclick="loadSample('poe')">Edgar Allan Poe - The Raven</button>
                        <button class="sample-btn" onclick="loadSample('dickinson')">Emily Dickinson - Hope</button>
                        <button class="sample-btn" onclick="loadSample('blake')">William Blake - The Tyger</button>
                    </div>
                </div>
            </div>
            
            <!-- Î∂ÑÏÑù Î≤ÑÌäº -->
            <div class="button-group">
                <button class="btn btn-primary" id="analyzeBtn" onclick="analyzePoem()">
                    üîç Ïãú Î∂ÑÏÑùÌïòÍ∏∞
                </button>
                <button class="btn btn-secondary" onclick="clearAll()">
                    üóëÔ∏è Ï¥àÍ∏∞Ìôî
                </button>
            </div>
            
            <!-- Î°úÎî© ÏÉÅÌÉú -->
            <div class="loading" id="loading">
                <div class="spinner"></div>
                <h3>AIÍ∞Ä ÏãúÎ•º Î∂ÑÏÑùÌïòÍ≥† ÏûàÏäµÎãàÎã§...</h3>
                <p>ÏàòÏÇ¨Î≤ï, Ïö¥Ïú®, Ï£ºÏ†ú Îì±ÏùÑ Ï¢ÖÌï©Ï†ÅÏúºÎ°ú Î∂ÑÏÑù Ï§ëÏûÖÎãàÎã§.</p>
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill"></div>
                </div>
                <p id="progressText">Î∂ÑÏÑù Ï§ÄÎπÑ Ï§ë...</p>
            </div>
            
            <!-- Ïò§Î•ò Î©îÏãúÏßÄ -->
            <div class="error-message" id="errorMessage">
                <h4>‚ùå Ïò§Î•ò Î∞úÏÉù</h4>
                <p id="errorText"></p>
            </div>
            
            <!-- Î∂ÑÏÑù Í≤∞Í≥º -->
            <div class="results" id="results">
                <div class="results-header">
                    <h2>üéâ Î∂ÑÏÑù ÏôÑÎ£å!</h2>
                    <p>ÏãúÏùò Îã§ÏñëÌïú Î¨∏ÌïôÏ†Å ÏöîÏÜåÎì§ÏùÑ Î∞úÍ≤¨ÌñàÏäµÎãàÎã§.</p>
                    <div class="results-stats" id="resultsStats">
                        <!-- ÌÜµÍ≥Ñ Ï†ïÎ≥¥Í∞Ä Ïó¨Í∏∞Ïóê ÌëúÏãúÎê©ÎãàÎã§ -->
                    </div>
                </div>
                
                <div class="results-content">
                    <div class="download-section">
                        <h3>üìÑ Î∂ÑÏÑù Î≥¥Í≥†ÏÑú Îã§Ïö¥Î°úÎìú</h3>
                        <button class="btn btn-primary" onclick="downloadReport()">
                            üíæ HTML Î≥¥Í≥†ÏÑú Îã§Ïö¥Î°úÎìú
                        </button>
                    </div>
                    
                    <!-- Î∂ÑÏÑù Í≤∞Í≥º ÎØ∏Î¶¨Î≥¥Í∏∞ -->
                    <div class="preview-section">
                        <div class="preview-title">
                            <span>üëÅÔ∏è</span>
                            <span>Î∂ÑÏÑù Í≤∞Í≥º ÎØ∏Î¶¨Î≥¥Í∏∞</span>
                        </div>
                        <div class="preview-content" id="previewContent">
                            <!-- Î∂ÑÏÑù Í≤∞Í≥º ÎØ∏Î¶¨Î≥¥Í∏∞Í∞Ä Ïó¨Í∏∞Ïóê ÌëúÏãúÎê©ÎãàÎã§ -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="footer">
            <p>ü§ñ Powered by Google Gemini AI & LangExtract</p>
            <p>üìö ÍµêÏú°Ïö© Ïãú Î∂ÑÏÑù ÎèÑÍµ¨ - Î¨¥Î£åÎ°ú ÏÇ¨Ïö©ÌïòÏÑ∏Ïöî</p>
            <p>üí° <a href="https://github.com/yourusername/poetry-analyzer" target="_blank">GitHubÏóêÏÑú ÏÜåÏä§ ÏΩîÎìú Î≥¥Í∏∞</a></p>
        </div>
    </div>

    <script>
        // Ï†ÑÏó≠ Î≥ÄÏàò
        let currentAnalysisResult = null;
        let analysisInProgress = false;
        
        // ÏÉòÌîå Ïãú Îç∞Ïù¥ÌÑ∞
        const samplePoems = {
            frost: {
                title: "The Road Not Taken by Robert Frost",
                text: `Two roads diverged in a yellow wood,
And sorry I could not travel both
And be one traveler, long I stood
And looked down one as far as I could
To where it bent in the undergrowth;

Then took the other, as just as fair,
And having perhaps the better claim,
Because it was grassy and wanted wear;
Though as for that the passing there
Had worn them really about the same,

And both that morning equally lay
In leaves no step had trodden black.
Oh, I kept the first for another day!
Yet knowing how way leads on to way,
I doubted if I should ever be back.

I shall be telling this with a sigh
Somewhere ages and ages hence:
Two roads diverged in a wood, and I‚Äî
I took the one less traveled by,
And that has made all the difference.`
            },
            
            shakespeare: {
                title: "Sonnet 18 by William Shakespeare",
                text: `Shall I compare thee to a summer's day?
Thou art more lovely and more temperate:
Rough winds do shake the darling buds of May,
And summer's lease hath all too short a date:
Sometime too hot the eye of heaven shines,
And often is his gold complexion dimm'd;
And every fair from fair sometime declines,
By chance or nature's changing course, untrimm'd;
But thy eternal summer shall not fade,
Nor lose possession of that fair thou owest;
Nor shall Death brag thou wander'st in his shade,
When in eternal lines to time thou growest:
So long as men can breathe or eyes can see,
So long lives this, and this gives life to thee.`
            },
            
            poe: {
                title: "The Raven by Edgar Allan Poe (excerpt)",
                text: `Once upon a midnight dreary, while I pondered, weak and weary,
Over many a quaint and curious volume of forgotten lore‚Äî
While I nodded, nearly napping, suddenly there came a tapping,
As of some one gently rapping, rapping at my chamber door.
"'Tis some visitor," I muttered, "tapping at my chamber door‚Äî
Only this and nothing more."

Ah, distinctly I remember it was in the bleak December;
And each separate dying ember wrought its ghost upon the floor.
Eagerly I wished the morrow;‚Äîvainly I had sought to borrow
From my books surcease of sorrow‚Äîsorrow for the lost Lenore‚Äî
For the rare and radiant maiden whom the angels name Lenore‚Äî
Nameless here for evermore.`
            },
            
            dickinson: {
                title: "Hope is the thing with feathers by Emily Dickinson",
                text: `Hope is the thing with feathers
That perches in the soul,
And sings the tune without the words,
And never stops at all,

And sweetest in the gale is heard;
And sore must be the storm
That could abash the little bird
That kept so many warm.

I've heard it in the chillest land,
And on the strangest sea;
Yet, never, in extremity,
It asked a crumb of me.`
            },
            
            blake: {
                title: "The Tyger by William Blake",
                text: `Tyger Tyger, burning bright,
In the forests of the night;
What immortal hand or eye,
Could frame thy fearful symmetry?

In what distant deeps or skies.
Burnt the fire of thine eyes?
On what wings dare he aspire?
What the hand, dare seize the fire?

And what shoulder, & what art,
Could twist the sinews of thy heart?
And when thy heart began to beat,
What dread hand? & what dread feet?`
            }
        };
        
        // Ï¥àÍ∏∞Ìôî
        document.addEventListener('DOMContentLoaded', function() {
            updateCharCount();
            loadApiKey();
            setupEventListeners();
        });
        
        function setupEventListeners() {
            // ÌÖçÏä§Ìä∏ ÏûÖÎ†• Ïãú Í∏ÄÏûê Ïàò ÏóÖÎç∞Ïù¥Ìä∏
            document.getElementById('poemInput').addEventListener('input', updateCharCount);
            
            // API ÌÇ§ Ï†ÄÏû•
            document.getElementById('apiKey').addEventListener('change', saveApiKey);
        }
        
        function updateCharCount() {
            const text = document.getElementById('poemInput').value;
            const count = text.length;
            document.getElementById('charCount').textContent = count.toLocaleString() + ' Í∏ÄÏûê';
        }
        
        function saveApiKey() {
            const apiKey = document.getElementById('apiKey').value;
            if (apiKey) {
                localStorage.setItem('gemini_api_key', apiKey);
            }
        }
        
        function loadApiKey() {
            const savedApiKey = localStorage.getItem('gemini_api_key');
            if (savedApiKey) {
                document.getElementById('apiKey').value = savedApiKey;
            }
        }
        
        function loadSample(type) {
            const sample = samplePoems[type];
            if (sample) {
                document.getElementById('poemTitle').value = sample.title;
                document.getElementById('poemInput').value = sample.text;
                updateCharCount();
            }
        }
        
        function clearAll() {
            document.getElementById('poemTitle').value = '';
            document.getElementById('poemInput').value = '';
            document.getElementById('results').style.display = 'none';
            document.getElementById('errorMessage').style.display = 'none';
            currentAnalysisResult = null;
            updateCharCount();
        }
        
        function showError(message) {
            document.getElementById('errorText').textContent = message;
            document.getElementById('errorMessage').style.display = 'block';
            document.getElementById('loading').style.display = 'none';
        }
        
        function hideError() {
            document.getElementById('errorMessage').style.display = 'none';
        }
        
        async function analyzePoem() {
            const apiKey = document.getElementById('apiKey').value.trim();
            const title = document.getElementById('poemTitle').value.trim() || 'Ïãú Î∂ÑÏÑù';
            const text = document.getElementById('poemInput').value.trim();
            
            // ÏûÖÎ†• Í≤ÄÏ¶ù
            if (!apiKey) {
                showError('Google Gemini API ÌÇ§Î•º ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî. AI StudioÏóêÏÑú Î¨¥Î£åÎ°ú Î∞úÍ∏âÎ∞õÏùÑ Ïàò ÏûàÏäµÎãàÎã§.');
                return;
            }
            
            if (!text) {
                showError('Î∂ÑÏÑùÌï† ÏãúÏùò ÏõêÎ¨∏ÏùÑ ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî.');
                return;
            }
            
            if (analysisInProgress) {
                return;
            }
            
            analysisInProgress = true;
            hideError();
            
            // UI ÏÉÅÌÉú Î≥ÄÍ≤Ω
            document.getElementById('analyzeBtn').disabled = true;
            document.getElementById('loading').style.display = 'block';
            document.getElementById('results').style.display = 'none';
            
            // ÏßÑÌñâÎ•† ÏãúÎÆ¨Î†àÏù¥ÏÖò
            simulateProgress();
            
            try {
                // Gemini API ÏßÅÏ†ë Ìò∏Ï∂ú
                const result = await callGeminiAPI(apiKey, text, title);
                
                if (result) {
                    currentAnalysisResult = result;
                    displayResults(result);
                } else {
                    showError('Î∂ÑÏÑù Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§. API ÌÇ§Î•º ÌôïÏù∏ÌïòÍ≥† Îã§Ïãú ÏãúÎèÑÌï¥Ï£ºÏÑ∏Ïöî.');
                }
            } catch (error) {
                console.error('Analysis error:', error);
                showError('Î∂ÑÏÑù Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§: ' + error.message);
            } finally {
                analysisInProgress = false;
                document.getElementById('analyzeBtn').disabled = false;
                document.getElementById('loading').style.display = 'none';
            }
        }
        
        async function callGeminiAPI(apiKey, text, title) {
            const prompt = `Îã§Ïùå ÏòÅÏñ¥ ÏãúÎ•º Ï¢ÖÌï©Ï†ÅÏúºÎ°ú Î∂ÑÏÑùÌï¥Ï£ºÏÑ∏Ïöî:

Ï†úÎ™©: ${title}

Ïãú ÏõêÎ¨∏:
${text}

Îã§Ïùå Ï∏°Î©¥ÏóêÏÑú Î∂ÑÏÑùÌï¥Ï£ºÏÑ∏Ïöî:
1. ÏàòÏÇ¨Î≤ï (Rhetorical Devices): ÏùÄÏú†, ÏßÅÏú†, ÏùòÏù∏Î≤ï, Í≥ºÏû•Î≤ï Îì±
2. ÏùåÏÑ± Í∏∞Î≤ï (Sound Devices): ÎëêÏö¥Î≤ï, Í∞ÅÏö¥Î≤ï, Î¶¨Îì¨, Ïö¥Ïú® Îì±
3. Ï£ºÏ†úÏôÄ ÏÉÅÏßï (Themes & Symbols): Ï£ºÏöî Ï£ºÏ†ú, ÏÉÅÏßï, Î™®Ìã∞ÌîÑ Îì±
4. Î¨∏Ï≤¥ÏôÄ Ïñ¥Ï°∞ (Style & Tone): Î¨∏Ï≤¥Ï†Å ÌäπÏßï, Ïñ¥Ï°∞, Î∂ÑÏúÑÍ∏∞ Îì±
5. Íµ¨Ï°∞ÏôÄ ÌòïÏãù (Structure & Form): ÏãúÏùò ÌòïÏãù, Íµ¨ÏÑ±, Ïö¥Ïú® Ï≤¥Í≥Ñ Îì±

Í∞Å Î∂ÑÏÑù Ìï≠Î™©Ïóê ÎåÄÌï¥ Íµ¨Ï≤¥Ï†ÅÏù∏ ÏòàÏãúÏôÄ Ìï®Íªò ÏÑ§Î™ÖÌï¥Ï£ºÏÑ∏Ïöî.
Î∂ÑÏÑù Í≤∞Í≥ºÎ•º JSON ÌòïÌÉúÎ°ú Íµ¨Ï°∞ÌôîÌï¥ÏÑú Ï†úÍ≥µÌï¥Ï£ºÏÑ∏Ïöî.

JSON ÌòïÏãù:
{
  "title": "Ïãú Ï†úÎ™©",
  "analysis": {
    "rhetorical_devices": [
      {
        "type": "Í∏∞Î≤ï Ïú†Ìòï",
        "text": "Ìï¥Îãπ Íµ¨Ï†à",
        "explanation": "ÏÑ§Î™Ö"
      }
    ],
    "sound_devices": [...],
    "themes_symbols": [...],
    "style_tone": [...],
    "structure_form": [...]
  },
  "summary": "Ï†ÑÏ≤¥Ï†ÅÏù∏ Î∂ÑÏÑù ÏöîÏïΩ"
}`;

            const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-pro:generateContent?key=${apiKey}`, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    contents: [{
                        parts: [{
                            text: prompt
                        }]
                    }]
                })
            });
            
            if (!response.ok) {
                throw new Error(`API Ìò∏Ï∂ú Ïã§Ìå®: ${response.status} ${response.statusText}`);
            }
            
            const data = await response.json();
            
            if (data.candidates && data.candidates[0] && data.candidates[0].content) {
                const content = data.candidates[0].content.parts[0].text;
                
                // JSON Ï∂îÏ∂ú ÏãúÎèÑ
                try {
                    const jsonMatch = content.match(/\{[\s\S]*\}/);
                    if (jsonMatch) {
                        return JSON.parse(jsonMatch[0]);
                    } else {
                        // JSONÏù¥ ÏóÜÏúºÎ©¥ ÌÖçÏä§Ìä∏ ÌååÏã±
                        return parseTextResponse(content, title);
                    }
                } catch (e) {
                    // JSON ÌååÏã± Ïã§Ìå® Ïãú ÌÖçÏä§Ìä∏ ÌååÏã±
                    return parseTextResponse(content, title);
                }
            } else {
                throw new Error('API ÏùëÎãµÏóêÏÑú ÏΩòÌÖêÏ∏†Î•º Ï∞æÏùÑ Ïàò ÏóÜÏäµÎãàÎã§.');
            }
        }
        
        function parseTextResponse(content, title) {
            // ÌÖçÏä§Ìä∏ ÏùëÎãµÏùÑ Íµ¨Ï°∞ÌôîÎêú ÌòïÌÉúÎ°ú ÌååÏã±
            const analysis = {
                rhetorical_devices: [],
                sound_devices: [],
                themes_symbols: [],
                style_tone: [],
                structure_form: []
            };
            
            // Í∞ÑÎã®Ìïú ÌÖçÏä§Ìä∏ ÌååÏã± Î°úÏßÅ
            const lines = content.split('\n');
            let currentSection = '';
            
            for (const line of lines) {
                const trimmed = line.trim();
                if (trimmed.includes('ÏàòÏÇ¨Î≤ï') || trimmed.includes('Rhetorical')) {
                    currentSection = 'rhetorical_devices';
                } else if (trimmed.includes('ÏùåÏÑ±') || trimmed.includes('Sound')) {
                    currentSection = 'sound_devices';
                } else if (trimmed.includes('Ï£ºÏ†ú') || trimmed.includes('Theme')) {
                    currentSection = 'themes_symbols';
                } else if (trimmed.includes('Î¨∏Ï≤¥') || trimmed.includes('Style')) {
                    currentSection = 'style_tone';
                } else if (trimmed.includes('Íµ¨Ï°∞') || trimmed.includes('Structure')) {
                    currentSection = 'structure_form';
                } else if (trimmed && currentSection && (trimmed.includes('-') || trimmed.includes('‚Ä¢'))) {
                    analysis[currentSection].push({
                        type: 'Î∂ÑÏÑù Ìï≠Î™©',
                        text: trimmed,
                        explanation: trimmed
                    });
                }
            }
            
            return {
                title: title,
                analysis: analysis,
                summary: content.substring(0, 500) + '...'
            };
        }
        
        function simulateProgress() {
            const progressFill = document.getElementById('progressFill');
            const progressText = document.getElementById('progressText');
            
            const steps = [
                { progress: 20, text: 'Ïãú Íµ¨Ï°∞ Î∂ÑÏÑù Ï§ë...' },
                { progress: 40, text: 'ÏàòÏÇ¨Î≤ï ÌÉêÏßÄ Ï§ë...' },
                { progress: 60, text: 'Ïö¥Ïú® Ìå®ÌÑ¥ Î∂ÑÏÑù Ï§ë...' },
                { progress: 80, text: 'Ï£ºÏ†ú Ìï¥ÏÑù Ï§ë...' },
                { progress: 95, text: 'Î≥¥Í≥†ÏÑú ÏÉùÏÑ± Ï§ë...' },
                { progress: 100, text: 'Î∂ÑÏÑù ÏôÑÎ£å!' }
            ];
            
            let currentStep = 0;
            
            const updateProgress = () => {
                if (currentStep < steps.length && analysisInProgress) {
                    const step = steps[currentStep];
                    progressFill.style.width = step.progress + '%';
                    progressText.textContent = step.text;
                    currentStep++;
                    
                    setTimeout(updateProgress, 1000 + Math.random() * 2000);
                }
            };
            
            updateProgress();
        }
        
        function displayResults(result) {
            const analysis = result.analysis;
            
            // ÌÜµÍ≥Ñ Í≥ÑÏÇ∞
            const totalDevices = Object.values(analysis).reduce((sum, category) => sum + category.length, 0);
            const categoriesWithResults = Object.values(analysis).filter(category => category.length > 0).length;
            
            // ÌÜµÍ≥Ñ ÌëúÏãú
            document.getElementById('resultsStats').innerHTML = `
                <div class="stat-card">
                    <span class="stat-number">${totalDevices}</span>
                    <span class="stat-label">Î∞úÍ≤¨Îêú Í∏∞Î≤ï</span>
                </div>
                <div class="stat-card">
                    <span class="stat-number">${categoriesWithResults}</span>
                    <span class="stat-label">Î∂ÑÏÑù ÏòÅÏó≠</span>
                </div>
                <div class="stat-card">
                    <span class="stat-number">${document.getElementById('poemInput').value.split(' ').length}</span>
                    <span class="stat-label">Îã®Ïñ¥ Ïàò</span>
                </div>
                <div class="stat-card">
                    <span class="stat-number">${document.getElementById('poemInput').value.split('\n').length}</span>
                    <span class="stat-label">Ìñâ Ïàò</span>
                </div>
            `;
            
            // ÎØ∏Î¶¨Î≥¥Í∏∞ ÏÉùÏÑ±
            let previewHtml = `<h3>${result.title}</h3><br>`;
            previewHtml += `<p><strong>Ï†ÑÏ≤¥ ÏöîÏïΩ:</strong> ${result.summary}</p><br>`;
            
            const categoryNames = {
                rhetorical_devices: 'üé≠ ÏàòÏÇ¨Î≤ï',
                sound_devices: 'üéµ ÏùåÏÑ± Í∏∞Î≤ï',
                themes_symbols: 'üîÆ Ï£ºÏ†úÏôÄ ÏÉÅÏßï',
                style_tone: '‚úçÔ∏è Î¨∏Ï≤¥ÏôÄ Ïñ¥Ï°∞',
                structure_form: 'üèóÔ∏è Íµ¨Ï°∞ÏôÄ ÌòïÏãù'
            };
            
            for (const [key, items] of Object.entries(analysis)) {
                if (items.length > 0) {
                    previewHtml += `<h4>${categoryNames[key]} (${items.length}Í∞ú)</h4>`;
                    items.slice(0, 3).forEach(item => {
                        previewHtml += `<p><strong>${item.type}:</strong> ${item.text}</p>`;
                        if (item.explanation && item.explanation !== item.text) {
                            previewHtml += `<p style="margin-left: 20px; color: #666;"><em>${item.explanation}</em></p>`;
                        }
                    });
                    if (items.length > 3) {
                        previewHtml += `<p><em>... Ïô∏ ${items.length - 3}Í∞ú Îçî</em></p>`;
                    }
                    previewHtml += '<br>';
                }
            }
            
            document.getElementById('previewContent').innerHTML = previewHtml;
            document.getElementById('results').style.display = 'block';
        }
        
        function generateHTMLReport(result) {
            const analysis = result.analysis;
            const poemText = document.getElementById('poemInput').value;
            
            return `<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>${result.title} - Ïãú Î∂ÑÏÑù Î≥¥Í≥†ÏÑú</title>
    <style>
        body {
            font-family: 'Georgia', serif;
            line-height: 1.6;
            max-width: 800px;
            margin: 0 auto;
            padding: 40px 20px;
            color: #333;
        }
        .header {
            text-align: center;
            margin-bottom: 40px;
            padding-bottom: 20px;
            border-bottom: 3px solid #667eea;
        }
        .header h1 {
            color: #667eea;
            margin-bottom: 10px;
        }
        .poem-text {
            background: #f8f9fa;
            padding: 30px;
            border-radius: 10px;
            border-left: 5px solid #667eea;
            margin: 30px 0;
            font-style: italic;
            white-space: pre-line;
        }
        .analysis-section {
            margin: 40px 0;
        }
        .section-title {
            color: #495057;
            border-bottom: 2px solid #e9ecef;
            padding-bottom: 10px;
            margin-bottom: 20px;
            font-size: 1.3em;
        }
        .analysis-item {
            background: white;
            border: 1px solid #e9ecef;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 15px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .item-type {
            background: #667eea;
            color: white;
            padding: 5px 12px;
            border-radius: 15px;
            font-size: 0.9em;
            font-weight: bold;
            display: inline-block;
            margin-bottom: 10px;
        }
        .item-text {
            font-weight: bold;
            color: #495057;
            margin-bottom: 8px;
        }
        .item-explanation {
            color: #6c757d;
            font-style: italic;
        }
        .summary {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 30px;
            border-radius: 10px;
            margin-top: 40px;
        }
        .summary h2 {
            margin-bottom: 15px;
        }
        .footer {
            text-align: center;
            margin-top: 50px;
            padding-top: 20px;
            border-top: 1px solid #e9ecef;
            color: #6c757d;
            font-size: 0.9em;
        }
        @media print {
            body { font-size: 12pt; }
            .header { page-break-after: avoid; }
            .analysis-item { page-break-inside: avoid; }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>üìö Ïãú Î∂ÑÏÑù Î≥¥Í≥†ÏÑú</h1>
        <h2>${result.title}</h2>
        <p>ÏÉùÏÑ±Ïùº: ${new Date().toLocaleDateString('ko-KR')}</p>
    </div>
    
    <div class="poem-text">
        <h3>üìú ÏõêÎ¨∏</h3>
        ${poemText}
    </div>
    
    ${Object.entries(analysis).map(([key, items]) => {
        if (items.length === 0) return '';
        
        const categoryNames = {
            rhetorical_devices: 'üé≠ ÏàòÏÇ¨Î≤ï Î∂ÑÏÑù',
            sound_devices: 'üéµ ÏùåÏÑ± Í∏∞Î≤ï Î∂ÑÏÑù',
            themes_symbols: 'üîÆ Ï£ºÏ†úÏôÄ ÏÉÅÏßï Î∂ÑÏÑù',
            style_tone: '‚úçÔ∏è Î¨∏Ï≤¥ÏôÄ Ïñ¥Ï°∞ Î∂ÑÏÑù',
            structure_form: 'üèóÔ∏è Íµ¨Ï°∞ÏôÄ ÌòïÏãù Î∂ÑÏÑù'
        };
        
        return `
        <div class="analysis-section">
            <h2 class="section-title">${categoryNames[key]}</h2>
            ${items.map(item => `
                <div class="analysis-item">
                    <div class="item-type">${item.type}</div>
                    <div class="item-text">"${item.text}"</div>
                    <div class="item-explanation">${item.explanation}</div>
                </div>
            `).join('')}
        </div>
        `;
    }).join('')}
    
    <div class="summary">
        <h2>üìä Ï¢ÖÌï© Î∂ÑÏÑù</h2>
        <p>${result.summary}</p>
    </div>
    
    <div class="footer">
        <p>ü§ñ AI Í∏∞Î∞ò Ïãú Î∂ÑÏÑù ÎèÑÍµ¨Î°ú ÏÉùÏÑ±Îê®</p>
        <p>üìö Poetry Analyzer - Powered by Google Gemini AI</p>
    </div>
</body>
</html>`;
        }
        
        function downloadReport() {
            if (!currentAnalysisResult) {
                showError('Îã§Ïö¥Î°úÎìúÌï† Î∂ÑÏÑù Í≤∞Í≥ºÍ∞Ä ÏóÜÏäµÎãàÎã§.');
                return;
            }
            
            const htmlContent = generateHTMLReport(currentAnalysisResult);
            const blob = new Blob([htmlContent], { type: 'text/html;charset=utf-8' });
            const url = URL.createObjectURL(blob);
            
            const link = document.createElement('a');
            link.href = url;
            link.download = `${currentAnalysisResult.title.replace(/[^a-zA-Z0-9Í∞Ä-Ìû£\s]/g, '_')}_Î∂ÑÏÑùÎ≥¥Í≥†ÏÑú.html`;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            URL.revokeObjectURL(url);
        }
    </script>
</body>
</html>