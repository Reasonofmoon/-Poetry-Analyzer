<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üìö Poetry Analyzer - AI Í∏∞Î∞ò Ïãú Î∂ÑÏÑù ÎèÑÍµ¨</title>
    <meta name="description" content="AIÎ•º ÌôúÏö©Ìïú ÏòÅÏñ¥ Ïãú Î∂ÑÏÑù ÎèÑÍµ¨. ÏàòÏÇ¨Î≤ï, Ïö¥Ïú®, Ï£ºÏ†ú Îì±ÏùÑ ÏûêÎèôÏúºÎ°ú Î∂ÑÏÑùÌïòÏó¨ ÍµêÏú° ÏûêÎ£åÎ•º ÏÉùÏÑ±Ìï©ÎãàÎã§.">
    <meta name="keywords" content="poetry analysis, AI, literature, education, Ïãú Î∂ÑÏÑù, Î¨∏Ìïô Î∂ÑÏÑù">
    
    <!-- Open Graph Meta Tags -->
    <meta property="og:title" content="Poetry Analyzer - AI Í∏∞Î∞ò Ïãú Î∂ÑÏÑù ÎèÑÍµ¨">
    <meta property="og:description" content="ÏòÅÏñ¥ ÏãúÎ•º AIÎ°ú Î∂ÑÏÑùÌïòÏó¨ ÏàòÏÇ¨Î≤ï, Ïö¥Ïú®, Ï£ºÏ†ú Îì±ÏùÑ ÏûêÎèôÏúºÎ°ú Ï∞æÏïÑÏ£ºÎäî ÍµêÏú°Ïö© ÎèÑÍµ¨">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://yourusername.github.io/poetry-analyzer">
    
    <!-- Favicon -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üìö</text></svg>">
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Georgia', 'Times New Roman', serif;
            line-height: 1.7;
            color: #1a1a1a;
            background: #ffffff;
            min-height: 100vh;
        }
        
        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 40px 20px;
        }
        
        .header {
            text-align: center;
            color: #1a1a1a;
            margin-bottom: 60px;
            padding: 60px 0;
            border-bottom: 3px solid #1a1a1a;
        }
        
        .header h1 {
            font-size: 3.5em;
            margin-bottom: 20px;
            font-weight: 300;
            letter-spacing: -2px;
            animation: fadeInDown 1s ease-out;
        }
        
        .header p {
            font-size: 1.2em;
            color: #666;
            font-weight: 300;
            animation: fadeInUp 1s ease-out 0.3s both;
        }
        
        .main-content {
            background: #ffffff;
            border: 3px solid #1a1a1a;
            padding: 50px;
            margin-bottom: 40px;
            animation: fadeIn 1s ease-out 0.6s both;
        }
        
        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 30px;
            margin-bottom: 60px;
        }
        
        .feature-card {
            background: #ffffff;
            color: #1a1a1a;
            padding: 30px;
            border: 2px solid #1a1a1a;
            text-align: center;
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .feature-card:hover {
            background: #1a1a1a;
            color: #ffffff;
        }
        
        .feature-icon {
            font-size: 2.5em;
            margin-bottom: 20px;
            display: block;
        }
        
        .feature-title {
            font-size: 1.1em;
            font-weight: 600;
            margin-bottom: 15px;
            letter-spacing: 0.5px;
        }
        
        .feature-desc {
            font-size: 0.9em;
            line-height: 1.5;
            opacity: 0.8;
        }
        
        .input-section {
            margin-bottom: 50px;
        }
        
        .input-section h2 {
            color: #1a1a1a;
            margin-bottom: 30px;
            font-size: 1.8em;
            font-weight: 300;
            letter-spacing: -1px;
            display: flex;
            align-items: center;
            gap: 15px;
            border-bottom: 1px solid #e0e0e0;
            padding-bottom: 15px;
        }
        
        .form-group {
            margin-bottom: 30px;
        }
        
        .form-group label {
            display: block;
            font-weight: 500;
            color: #1a1a1a;
            margin-bottom: 12px;
            font-size: 1em;
            letter-spacing: 0.3px;
        }
        
        .form-group input,
        .form-group textarea {
            width: 100%;
            padding: 18px;
            border: 2px solid #1a1a1a;
            background: #ffffff;
            color: #1a1a1a;
            font-size: 16px;
            transition: all 0.3s ease;
            font-family: 'Georgia', serif;
        }
        
        .form-group input:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #1a1a1a;
            background: #f9f9f9;
        }
        
        #poemInput {
            min-height: 300px;
            font-family: 'Georgia', serif;
            line-height: 1.8;
            resize: vertical;
        }
        
        .char-count {
            text-align: right;
            color: #666;
            font-size: 13px;
            margin-top: 10px;
            font-style: italic;
        }
        
        .sample-section {
            margin-top: 30px;
            padding: 30px;
            background: #ffffff;
            border: 2px solid #e0e0e0;
        }
        
        .sample-section h3 {
            color: #1a1a1a;
            margin-bottom: 20px;
            font-size: 1.1em;
            font-weight: 500;
            letter-spacing: 0.5px;
        }
        
        .sample-buttons {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }
        
        .sample-btn {
            padding: 12px 20px;
            background: #ffffff;
            border: 2px solid #1a1a1a;
            cursor: pointer;
            font-size: 13px;
            transition: all 0.3s ease;
            color: #1a1a1a;
            font-weight: 400;
            letter-spacing: 0.3px;
        }
        
        .sample-btn:hover {
            background: #1a1a1a;
            color: #ffffff;
        }
        
        .api-key-section {
            background: #ffffff;
            border: 2px solid #1a1a1a;
            padding: 30px;
            margin-bottom: 40px;
        }
        
        .api-key-section h3 {
            color: #1a1a1a;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 15px;
            font-weight: 500;
            font-size: 1.2em;
        }
        
        .api-key-section p {
            color: #1a1a1a;
            margin-bottom: 15px;
            line-height: 1.7;
        }
        
        .api-key-section a {
            color: #1a1a1a;
            text-decoration: underline;
            font-weight: 600;
        }
        
        .api-key-section a:hover {
            text-decoration: none;
        }
        
        .btn {
            padding: 18px 35px;
            border: 2px solid #1a1a1a;
            background: #ffffff;
            color: #1a1a1a;
            font-size: 16px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 12px;
            text-decoration: none;
            text-align: center;
            letter-spacing: 0.5px;
            font-family: 'Georgia', serif;
        }
        
        .btn-primary {
            background: #1a1a1a;
            color: #ffffff;
        }
        
        .btn-primary:hover {
            background: #ffffff;
            color: #1a1a1a;
        }
        
        .btn-secondary {
            background: #ffffff;
            color: #1a1a1a;
        }
        
        .btn-secondary:hover {
            background: #1a1a1a;
            color: #ffffff;
        }
        
        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none !important;
        }
        
        .button-group {
            display: flex;
            gap: 20px;
            justify-content: center;
            margin: 50px 0;
            flex-wrap: wrap;
        }
        
        .loading {
            display: none;
            text-align: center;
            padding: 60px;
            color: #1a1a1a;
            border: 2px solid #1a1a1a;
            background: #ffffff;
            margin: 40px 0;
        }
        
        .loading .spinner {
            width: 50px;
            height: 50px;
            border: 3px solid #e0e0e0;
            border-top: 3px solid #1a1a1a;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 30px;
        }
        
        .loading h3 {
            margin-bottom: 20px;
            font-size: 1.3em;
            font-weight: 400;
        }
        
        .loading p {
            font-size: 1em;
            opacity: 0.7;
            line-height: 1.6;
        }
        
        .progress-bar {
            width: 100%;
            height: 8px;
            background: #e0e0e0;
            overflow: hidden;
            margin: 30px 0;
        }
        
        .progress-fill {
            height: 100%;
            background: #1a1a1a;
            width: 0%;
            transition: width 0.5s ease;
        }
        
        .error-message {
            background: #ffffff;
            border: 2px solid #1a1a1a;
            color: #1a1a1a;
            padding: 25px;
            margin: 30px 0;
            display: none;
        }
        
        .error-message h4 {
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 12px;
            font-weight: 500;
        }
        
        .results {
            display: none;
            margin-top: 50px;
        }
        
        .results-header {
            background: #1a1a1a;
            color: #ffffff;
            padding: 40px;
            text-align: center;
        }
        
        .results-header h2 {
            margin-bottom: 20px;
            font-size: 1.8em;
            font-weight: 300;
            letter-spacing: -1px;
        }
        
        .results-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 25px;
            margin-top: 30px;
        }
        
        .stat-card {
            background: rgba(255,255,255,0.1);
            padding: 20px;
            text-align: center;
            border: 1px solid rgba(255,255,255,0.2);
        }
        
        .stat-number {
            font-size: 1.8em;
            font-weight: 300;
            display: block;
            margin-bottom: 8px;
        }
        
        .stat-label {
            font-size: 0.85em;
            opacity: 0.8;
            letter-spacing: 0.5px;
        }
        
        .results-content {
            background: #ffffff;
            border: 2px solid #1a1a1a;
            border-top: none;
            padding: 50px;
        }
        
        .download-section {
            text-align: center;
            margin-bottom: 40px;
        }
        
        .download-section h3 {
            color: #1a1a1a;
            margin-bottom: 25px;
            font-size: 1.3em;
            font-weight: 400;
            letter-spacing: 0.5px;
        }
        
        .preview-section {
            margin-top: 40px;
            padding: 35px;
            background: #ffffff;
            border: 2px solid #e0e0e0;
        }
        
        .preview-title {
            font-size: 1.2em;
            font-weight: 500;
            color: #1a1a1a;
            margin-bottom: 25px;
            display: flex;
            align-items: center;
            gap: 12px;
            letter-spacing: 0.3px;
        }
        
        .preview-content {
            max-height: 600px;
            overflow-y: auto;
            border: 1px solid #e0e0e0;
            padding: 25px;
            background: #fafafa;
            font-size: 0.9em;
            line-height: 1.7;
            color: #1a1a1a;
        }
        
        .footer {
            text-align: center;
            color: #1a1a1a;
            margin-top: 80px;
            padding: 40px 0;
            border-top: 1px solid #e0e0e0;
        }
        
        .footer p {
            margin-bottom: 12px;
            opacity: 0.7;
            font-size: 0.9em;
        }
        
        .footer a {
            color: #1a1a1a;
            text-decoration: underline;
        }
        
        .footer a:hover {
            text-decoration: none;
        }
        
        /* Ïï†ÎãàÎ©îÏù¥ÏÖò */
        @keyframes fadeInDown {
            from {
                opacity: 0;
                transform: translateY(-30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        @keyframes fadeIn {
            from {
                opacity: 0;
            }
            to {
                opacity: 1;
            }
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* Î∞òÏùëÌòï ÎîîÏûêÏù∏ */
        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }
            
            .header h1 {
                font-size: 2.2em;
            }
            
            .header p {
                font-size: 1.1em;
            }
            
            .main-content {
                padding: 25px;
            }
            
            .feature-grid {
                grid-template-columns: 1fr;
            }
            
            .button-group {
                flex-direction: column;
                align-items: center;
            }
            
            .btn {
                width: 100%;
                max-width: 300px;
                justify-content: center;
            }
            
            .sample-buttons {
                flex-direction: column;
            }
            
            .sample-btn {
                text-align: center;
            }
        }
        
        /* Ï∂îÍ∞Ä Ïä§ÌÉÄÏùºÎßÅ */
        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            background: #f0f0f0 !important;
            color: #999 !important;
            border-color: #ddd !important;
        }
        
        .form-group input::placeholder,
        .form-group textarea::placeholder {
            color: #999;
            font-style: italic;
        }
        
        /* Ïä§ÌÅ¨Î°§Î∞î Ïä§ÌÉÄÏùºÎßÅ */
        .preview-content::-webkit-scrollbar {
            width: 8px;
        }
        
        .preview-content::-webkit-scrollbar-track {
            background: #f0f0f0;
        }
        
        .preview-content::-webkit-scrollbar-thumb {
            background: #1a1a1a;
        }
        
        .preview-content::-webkit-scrollbar-thumb:hover {
            background: #333;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üìö Poetry Analyzer</h1>
            <p>AI Í∏∞Î∞ò ÏòÅÏñ¥ Ïãú Î∂ÑÏÑù ÎèÑÍµ¨ - ÏàòÏÇ¨Î≤ï, Ïö¥Ïú®, Ï£ºÏ†úÎ•º ÏûêÎèôÏúºÎ°ú Î∂ÑÏÑùÌï©ÎãàÎã§</p>
        </div>
        
        <div class="main-content">
            <!-- Ï£ºÏöî Í∏∞Îä• ÏÜåÍ∞ú -->
            <div class="feature-grid">
                <div class="feature-card">
                    <span class="feature-icon">üé≠</span>
                    <div class="feature-title">ÏàòÏÇ¨Î≤ï Î∂ÑÏÑù</div>
                    <div class="feature-desc">ÏùÄÏú†, ÏßÅÏú†, ÏùòÏù∏Î≤ï Îì± Îã§ÏñëÌïú ÏàòÏÇ¨Î≤ïÏùÑ ÏûêÎèôÏúºÎ°ú ÏãùÎ≥Ñ</div>
                </div>
                <div class="feature-card">
                    <span class="feature-icon">üéµ</span>
                    <div class="feature-title">Ïö¥Ïú® Î∂ÑÏÑù</div>
                    <div class="feature-desc">ÎëêÏö¥Î≤ï, Í∞ÅÏö¥Î≤ï, Î¶¨Îì¨ Ìå®ÌÑ¥ÏùÑ Ï†ïÎ∞ÄÌïòÍ≤å Î∂ÑÏÑù</div>
                </div>
                <div class="feature-card">
                    <span class="feature-icon">üîÆ</span>
                    <div class="feature-title">Ï£ºÏ†ú Î∂ÑÏÑù</div>
                    <div class="feature-desc">ÏãúÏùò Ï£ºÏ†ú, ÏÉÅÏßï, Î™®Ìã∞ÌîÑÎ•º ÍπäÏù¥ ÏûàÍ≤å Ìï¥ÏÑù</div>
                </div>
                <div class="feature-card">
                    <span class="feature-icon">üìÑ</span>
                    <div class="feature-title">HTML Î≥¥Í≥†ÏÑú</div>
                    <div class="feature-desc">ÏïÑÎ¶ÑÎã§Ïö¥ HTML ÌòïÌÉúÏùò Î∂ÑÏÑù Î≥¥Í≥†ÏÑú ÏûêÎèô ÏÉùÏÑ±</div>
                </div>
            </div>
            
            <!-- API ÌÇ§ ÏÑ§Ï†ï ÏïàÎÇ¥ -->
            <div class="api-key-section">
                <h3>üîë API ÌÇ§ ÏÑ§Ï†ï ÌïÑÏöî</h3>
                <p>Ïù¥ ÎèÑÍµ¨Îäî Google Gemini APIÎ•º ÏÇ¨Ïö©Ìï©ÎãàÎã§. Î¨¥Î£åÎ°ú ÏÇ¨Ïö©Ìï† Ïàò ÏûàÏúºÎ©∞, ÏïÑÎûò Îã®Í≥ÑÎ•º Îî∞Îùº API ÌÇ§Î•º ÏÑ§Ï†ïÌï¥Ï£ºÏÑ∏Ïöî:</p>
                <ol style="margin-left: 20px; margin-bottom: 15px;">
                    <li><a href="https://aistudio.google.com/app/apikey" target="_blank">Google AI Studio</a>ÏóêÏÑú Î¨¥Î£å API ÌÇ§ Î∞úÍ∏â</li>
                    <li>ÏïÑÎûò ÏûÖÎ†•ÎûÄÏóê API ÌÇ§Î•º ÏûÖÎ†•</li>
                    <li>API ÌÇ§Îäî Î∏åÎùºÏö∞Ï†ÄÏóêÎßå Ï†ÄÏû•ÎêòÎ©∞ Ïô∏Î∂ÄÎ°ú Ï†ÑÏÜ°ÎêòÏßÄ ÏïäÏäµÎãàÎã§</li>
                </ol>
            </div>
            
            <!-- API ÌÇ§ ÏûÖÎ†• -->
            <div class="form-group">
                <label for="apiKey">üîë Google Gemini API ÌÇ§</label>
                <input type="password" id="apiKey" placeholder="Ïó¨Í∏∞Ïóê API ÌÇ§Î•º ÏûÖÎ†•ÌïòÏÑ∏Ïöî (Ïòà: AIzaSy...)">
                <div class="char-count">API ÌÇ§Îäî Î°úÏª¨ÏóêÎßå Ï†ÄÏû•ÎêòÎ©∞ ÏïàÏ†ÑÌï©ÎãàÎã§</div>
            </div>
            
            <!-- Î™®Îç∏ ÏÑ†ÌÉù -->
            <div class="form-group">
                <label for="modelSelect">ü§ñ Gemini Î™®Îç∏ ÏÑ†ÌÉù</label>
                <select id="modelSelect">
                    <option value="gemini-2.5-flash" selected>Gemini 2.5 Flash (Í∂åÏû•) - Îπ†Î•¥Í≥† ÎπÑÏö© Ìö®Ïú®Ï†Å</option>
                    <option value="gemini-2.5-pro">Gemini 2.5 Pro - Í≥†Í∏â Ï∂îÎ°† Î∞è Î∂ÑÏÑù</option>
                    <option value="gemini-2.5-flash-lite">Gemini 2.5 Flash-Lite - Í∞ÄÏû• Í≤ΩÏ†úÏ†Å</option>
                    <option value="gemini-2.0-flash">Gemini 2.0 Flash - Ï∞®ÏÑ∏ÎåÄ Í∏∞Îä•</option>
                </select>
                <div class="char-count">‚ö° Îπ†Î•¥Í≥† Í∑†ÌòïÏû°Ìûå Î∂ÑÏÑùÏùÑ Ï†úÍ≥µÌï©ÎãàÎã§. (Í∂åÏû•)</div>
            </div>
            
            <!-- Î™®Îç∏ ÎπÑÍµê Ï†ïÎ≥¥ -->
            <div class="sample-section">
                <h3>ü§ñ Î™®Îç∏Î≥Ñ ÌäπÏßï ÎπÑÍµê</h3>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-top: 15px;">
                    <div style="background: white; padding: 15px; border-radius: 8px; border: 2px solid #e9ecef;">
                        <h4 style="color: #667eea; margin-bottom: 8px;">üß† Gemini 2.5 Pro</h4>
                        <p style="font-size: 0.9em; color: #6c757d;">ÏµúÍ≥† ÌíàÏßàÏùò Ïã¨Ï∏µ Î∂ÑÏÑù<br>Î≥µÏû°Ìïú Î¨∏ÌïôÏ†Å Í¥ÄÍ≥Ñ Ìï¥ÏÑù<br>Ï≤òÎ¶¨ ÏãúÍ∞Ñ: ÎäêÎ¶º</p>
                    </div>
                    <div style="background: white; padding: 15px; border-radius: 8px; border: 2px solid #28a745;">
                        <h4 style="color: #28a745; margin-bottom: 8px;">‚ö° Gemini 2.5 Flash</h4>
                        <p style="font-size: 0.9em; color: #6c757d;">Í∑†ÌòïÏû°Ìûå ÌíàÏßàÍ≥º ÏÜçÎèÑ<br>ÎåÄÎ∂ÄÎ∂ÑÏùò Ïö©ÎèÑÏóê ÏµúÏ†Å<br>Ï≤òÎ¶¨ ÏãúÍ∞Ñ: Î≥¥ÌÜµ (Í∂åÏû•)</p>
                    </div>
                    <div style="background: white; padding: 15px; border-radius: 8px; border: 2px solid #ffc107;">
                        <h4 style="color: #ffc107; margin-bottom: 8px;">üí® Flash-Lite</h4>
                        <p style="font-size: 0.9em; color: #6c757d;">Îπ†Î•¥Í≥† Í≤ΩÏ†úÏ†Å<br>Í∏∞Î≥∏Ï†ÅÏù∏ Î∂ÑÏÑù Ï†úÍ≥µ<br>Ï≤òÎ¶¨ ÏãúÍ∞Ñ: Îπ†Î¶Ñ</p>
                    </div>
                    <div style="background: white; padding: 15px; border-radius: 8px; border: 2px solid #dc3545;">
                        <h4 style="color: #dc3545; margin-bottom: 8px;">üöÄ Gemini 2.0</h4>
                        <p style="font-size: 0.9em; color: #6c757d;">Ï∞®ÏÑ∏ÎåÄ AI Í∏∞Îä•<br>ÌòÅÏã†Ï†ÅÏù∏ Î∂ÑÏÑù Î∞©Ïãù<br>Ï≤òÎ¶¨ ÏãúÍ∞Ñ: Ï§ëÍ∞Ñ</p>
                    </div>
                </div>
            </div>
            
            <!-- Ïãú Ï†úÎ™© ÏûÖÎ†• -->
            <div class="input-section">
                <h2>üìù Ïãú Ï†ïÎ≥¥ ÏûÖÎ†•</h2>
                
                <div class="form-group">
                    <label for="poemTitle">Ïãú Ï†úÎ™© (ÏÑ†ÌÉùÏÇ¨Ìï≠)</label>
                    <input type="text" id="poemTitle" placeholder="Ïòà: The Road Not Taken by Robert Frost">
                </div>
                
                <!-- Ïãú ÏõêÎ¨∏ ÏûÖÎ†• -->
                <div class="form-group">
                    <label for="poemInput">Ïãú ÏõêÎ¨∏</label>
                    <textarea id="poemInput" placeholder="ÏòÅÏñ¥ ÏãúÏùò ÏõêÎ¨∏ÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî...

ÏòàÏãú:
Two roads diverged in a yellow wood,
And sorry I could not travel both
And be one traveler, long I stood
And looked down one as far as I could
To where it bent in the undergrowth;"></textarea>
                    <div class="char-count" id="charCount">0 Í∏ÄÏûê</div>
                </div>
                
                <!-- ÏÉòÌîå Ïãú -->
                <div class="sample-section">
                    <h3>üìñ Ïú†Î™ÖÌïú Ïãú ÏÉòÌîå</h3>
                    <div class="sample-buttons">
                        <button class="sample-btn" onclick="loadSample('frost')">Robert Frost - The Road Not Taken</button>
                        <button class="sample-btn" onclick="loadSample('shakespeare')">Shakespeare - Sonnet 18</button>
                        <button class="sample-btn" onclick="loadSample('poe')">Edgar Allan Poe - The Raven</button>
                        <button class="sample-btn" onclick="loadSample('dickinson')">Emily Dickinson - Hope</button>
                        <button class="sample-btn" onclick="loadSample('blake')">William Blake - The Tyger</button>
                    </div>
                </div>
            </div>
            
            <!-- Î∂ÑÏÑù Î≤ÑÌäº -->
            <div class="button-group">
                <button class="btn btn-primary" id="analyzeBtn" onclick="analyzePoem()">
                    üîç Ïãú Î∂ÑÏÑùÌïòÍ∏∞
                </button>
                <button class="btn btn-secondary" onclick="clearAll()">
                    üóëÔ∏è Ï¥àÍ∏∞Ìôî
                </button>
            </div>
            
            <!-- Î°úÎî© ÏÉÅÌÉú -->
            <div class="loading" id="loading">
                <div class="spinner"></div>
                <h3>AIÍ∞Ä ÏãúÎ•º Î∂ÑÏÑùÌïòÍ≥† ÏûàÏäµÎãàÎã§...</h3>
                <p>ÏàòÏÇ¨Î≤ï, Ïö¥Ïú®, Ï£ºÏ†ú Îì±ÏùÑ Ï¢ÖÌï©Ï†ÅÏúºÎ°ú Î∂ÑÏÑù Ï§ëÏûÖÎãàÎã§.</p>
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill"></div>
                </div>
                <p id="progressText">Î∂ÑÏÑù Ï§ÄÎπÑ Ï§ë...</p>
            </div>
            
            <!-- Ïò§Î•ò Î©îÏãúÏßÄ -->
            <div class="error-message" id="errorMessage">
                <h4>‚ùå Ïò§Î•ò Î∞úÏÉù</h4>
                <p id="errorText"></p>
            </div>
            
            <!-- Î∂ÑÏÑù Í≤∞Í≥º -->
            <div class="results" id="results">
                <div class="results-header">
                    <h2>üéâ Î∂ÑÏÑù ÏôÑÎ£å!</h2>
                    <p>ÏãúÏùò Îã§ÏñëÌïú Î¨∏ÌïôÏ†Å ÏöîÏÜåÎì§ÏùÑ Î∞úÍ≤¨ÌñàÏäµÎãàÎã§.</p>
                    <div class="results-stats" id="resultsStats">
                        <!-- ÌÜµÍ≥Ñ Ï†ïÎ≥¥Í∞Ä Ïó¨Í∏∞Ïóê ÌëúÏãúÎê©ÎãàÎã§ -->
                    </div>
                </div>
                
                <div class="results-content">
                    <div class="download-section">
                        <h3>üìÑ Î∂ÑÏÑù Î≥¥Í≥†ÏÑú Îã§Ïö¥Î°úÎìú</h3>
                        <button class="btn btn-primary" onclick="downloadReport()">
                            üíæ HTML Î≥¥Í≥†ÏÑú Îã§Ïö¥Î°úÎìú
                        </button>
                    </div>
                    
                    <!-- Î∂ÑÏÑù Í≤∞Í≥º ÎØ∏Î¶¨Î≥¥Í∏∞ -->
                    <div class="preview-section">
                        <div class="preview-title">
                            <span>üëÅÔ∏è</span>
                            <span>Î∂ÑÏÑù Í≤∞Í≥º ÎØ∏Î¶¨Î≥¥Í∏∞</span>
                        </div>
                        <div class="preview-content" id="previewContent">
                            <!-- Î∂ÑÏÑù Í≤∞Í≥º ÎØ∏Î¶¨Î≥¥Í∏∞Í∞Ä Ïó¨Í∏∞Ïóê ÌëúÏãúÎê©ÎãàÎã§ -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="footer">
            <p>ü§ñ Powered by Google Gemini AI & LangExtract</p>
            <p>üìö ÍµêÏú°Ïö© Ïãú Î∂ÑÏÑù ÎèÑÍµ¨ - Î¨¥Î£åÎ°ú ÏÇ¨Ïö©ÌïòÏÑ∏Ïöî</p>
            <p>üí° <a href="https://github.com/yourusername/poetry-analyzer" target="_blank">GitHubÏóêÏÑú ÏÜåÏä§ ÏΩîÎìú Î≥¥Í∏∞</a></p>
        </div>
    </div>

    <script>
        // Ï†ÑÏó≠ Î≥ÄÏàò
        let currentAnalysisResult = null;
        let analysisInProgress = false;
        
        // ÏÉòÌîå Ïãú Îç∞Ïù¥ÌÑ∞
        const samplePoems = {
            frost: {
                title: "The Road Not Taken by Robert Frost",
                text: `Two roads diverged in a yellow wood,
And sorry I could not travel both
And be one traveler, long I stood
And looked down one as far as I could
To where it bent in the undergrowth;

Then took the other, as just as fair,
And having perhaps the better claim,
Because it was grassy and wanted wear;
Though as for that the passing there
Had worn them really about the same,

And both that morning equally lay
In leaves no step had trodden black.
Oh, I kept the first for another day!
Yet knowing how way leads on to way,
I doubted if I should ever be back.

I shall be telling this with a sigh
Somewhere ages and ages hence:
Two roads diverged in a wood, and I‚Äî
I took the one less traveled by,
And that has made all the difference.`
            },
            
            shakespeare: {
                title: "Sonnet 18 by William Shakespeare",
                text: `Shall I compare thee to a summer's day?
Thou art more lovely and more temperate:
Rough winds do shake the darling buds of May,
And summer's lease hath all too short a date:
Sometime too hot the eye of heaven shines,
And often is his gold complexion dimm'd;
And every fair from fair sometime declines,
By chance or nature's changing course, untrimm'd;
But thy eternal summer shall not fade,
Nor lose possession of that fair thou owest;
Nor shall Death brag thou wander'st in his shade,
When in eternal lines to time thou growest:
So long as men can breathe or eyes can see,
So long lives this, and this gives life to thee.`
            },
            
            poe: {
                title: "The Raven by Edgar Allan Poe (excerpt)",
                text: `Once upon a midnight dreary, while I pondered, weak and weary,
Over many a quaint and curious volume of forgotten lore‚Äî
While I nodded, nearly napping, suddenly there came a tapping,
As of some one gently rapping, rapping at my chamber door.
"'Tis some visitor," I muttered, "tapping at my chamber door‚Äî
Only this and nothing more."

Ah, distinctly I remember it was in the bleak December;
And each separate dying ember wrought its ghost upon the floor.
Eagerly I wished the morrow;‚Äîvainly I had sought to borrow
From my books surcease of sorrow‚Äîsorrow for the lost Lenore‚Äî
For the rare and radiant maiden whom the angels name Lenore‚Äî
Nameless here for evermore.`
            },
            
            dickinson: {
                title: "Hope is the thing with feathers by Emily Dickinson",
                text: `Hope is the thing with feathers
That perches in the soul,
And sings the tune without the words,
And never stops at all,

And sweetest in the gale is heard;
And sore must be the storm
That could abash the little bird
That kept so many warm.

I've heard it in the chillest land,
And on the strangest sea;
Yet, never, in extremity,
It asked a crumb of me.`
            },
            
            blake: {
                title: "The Tyger by William Blake",
                text: `Tyger Tyger, burning bright,
In the forests of the night;
What immortal hand or eye,
Could frame thy fearful symmetry?

In what distant deeps or skies.
Burnt the fire of thine eyes?
On what wings dare he aspire?
What the hand, dare seize the fire?

And what shoulder, & what art,
Could twist the sinews of thy heart?
And when thy heart began to beat,
What dread hand? & what dread feet?`
            }
        };
        
        // Ï¥àÍ∏∞Ìôî
        document.addEventListener('DOMContentLoaded', function() {
            updateCharCount();
            loadApiKey();
            setupEventListeners();
        });
        
        function setupEventListeners() {
            // ÌÖçÏä§Ìä∏ ÏûÖÎ†• Ïãú Í∏ÄÏûê Ïàò ÏóÖÎç∞Ïù¥Ìä∏
            document.getElementById('poemInput').addEventListener('input', updateCharCount);
            
            // API ÌÇ§ Ï†ÄÏû•
            document.getElementById('apiKey').addEventListener('change', saveApiKey);
            
            // Î™®Îç∏ ÏÑ†ÌÉù Ïãú ÏÑ§Î™Ö ÏóÖÎç∞Ïù¥Ìä∏
            document.getElementById('modelSelect').addEventListener('change', updateModelDescription);
        }
        
        function updateModelDescription() {
            const selectedModel = document.getElementById('modelSelect').value;
            const descriptions = {
                'gemini-2.5-pro': 'üß† Í∞ÄÏû• Í∞ïÎ†•Ìïú Î∂ÑÏÑù Îä•Î†•ÏùÑ Ï†úÍ≥µÌïòÏßÄÎßå Ï≤òÎ¶¨ ÏãúÍ∞ÑÏù¥ Í∏∏ Ïàò ÏûàÏäµÎãàÎã§.',
                'gemini-2.5-flash': '‚ö° Îπ†Î•¥Í≥† Í∑†ÌòïÏû°Ìûå Î∂ÑÏÑùÏùÑ Ï†úÍ≥µÌï©ÎãàÎã§. (Í∂åÏû•)',
                'gemini-2.5-flash-lite': 'üí∞ Í∞ÄÏû• Í≤ΩÏ†úÏ†ÅÏù¥Î©∞ Îπ†Î•∏ Í∏∞Î≥∏ Î∂ÑÏÑùÏùÑ Ï†úÍ≥µÌï©ÎãàÎã§.',
                'gemini-2.0-flash': 'üöÄ Ï∞®ÏÑ∏ÎåÄ Í∏∞Îä•ÏúºÎ°ú ÌòÅÏã†Ï†ÅÏù∏ Î∂ÑÏÑùÏùÑ Ï†úÍ≥µÌï©ÎãàÎã§.'
            };
            
            const charCountElement = document.querySelector('#modelSelect + .char-count');
            if (charCountElement) {
                charCountElement.textContent = descriptions[selectedModel] || 'Î™®Îç∏Ïóê Îî∞Îùº Î∂ÑÏÑù ÌíàÏßàÍ≥º ÏÜçÎèÑÍ∞Ä Îã¨ÎùºÏßëÎãàÎã§';
            }
        }
        
        function updateCharCount() {
            const text = document.getElementById('poemInput').value;
            const count = text.length;
            document.getElementById('charCount').textContent = count.toLocaleString() + ' Í∏ÄÏûê';
        }
        
        function saveApiKey() {
            const apiKey = document.getElementById('apiKey').value;
            if (apiKey) {
                localStorage.setItem('gemini_api_key', apiKey);
            }
        }
        
        function loadApiKey() {
            const savedApiKey = localStorage.getItem('gemini_api_key');
            if (savedApiKey) {
                document.getElementById('apiKey').value = savedApiKey;
            }
        }
        
        function loadSample(type) {
            const sample = samplePoems[type];
            if (sample) {
                document.getElementById('poemTitle').value = sample.title;
                document.getElementById('poemInput').value = sample.text;
                updateCharCount();
            }
        }
        
        function clearAll() {
            document.getElementById('poemTitle').value = '';
            document.getElementById('poemInput').value = '';
            document.getElementById('results').style.display = 'none';
            document.getElementById('errorMessage').style.display = 'none';
            currentAnalysisResult = null;
            updateCharCount();
        }
        
        function showError(message) {
            document.getElementById('errorText').textContent = message;
            document.getElementById('errorMessage').style.display = 'block';
            document.getElementById('loading').style.display = 'none';
        }
        
        function hideError() {
            document.getElementById('errorMessage').style.display = 'none';
        }
        
        async function analyzePoem() {
            const apiKey = document.getElementById('apiKey').value.trim();
            const title = document.getElementById('poemTitle').value.trim() || 'Ïãú Î∂ÑÏÑù';
            const text = document.getElementById('poemInput').value.trim();
            
            // ÏûÖÎ†• Í≤ÄÏ¶ù
            if (!apiKey) {
                showError('Google Gemini API ÌÇ§Î•º ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî. AI StudioÏóêÏÑú Î¨¥Î£åÎ°ú Î∞úÍ∏âÎ∞õÏùÑ Ïàò ÏûàÏäµÎãàÎã§.');
                return;
            }
            
            if (apiKey.length < 20) {
                showError('API ÌÇ§Í∞Ä ÎÑàÎ¨¥ ÏßßÏäµÎãàÎã§. Ïò¨Î∞îÎ•∏ Gemini API ÌÇ§Ïù∏ÏßÄ ÌôïÏù∏Ìï¥Ï£ºÏÑ∏Ïöî.');
                return;
            }
            
            if (!text) {
                showError('Î∂ÑÏÑùÌï† ÏãúÏùò ÏõêÎ¨∏ÏùÑ ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî.');
                return;
            }
            
            if (text.length < 10) {
                showError('Î∂ÑÏÑùÌïòÍ∏∞ÏóêÎäî ÌÖçÏä§Ìä∏Í∞Ä ÎÑàÎ¨¥ ÏßßÏäµÎãàÎã§. Îçî Í∏¥ ÏãúÎ•º ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî.');
                return;
            }
            
            if (analysisInProgress) {
                return;
            }
            
            analysisInProgress = true;
            hideError();
            
            // UI ÏÉÅÌÉú Î≥ÄÍ≤Ω
            document.getElementById('analyzeBtn').disabled = true;
            document.getElementById('loading').style.display = 'block';
            document.getElementById('results').style.display = 'none';
            
            // ÏßÑÌñâÎ•† ÏãúÎÆ¨Î†àÏù¥ÏÖò
            simulateProgress();
            
            try {
                // Gemini API ÏßÅÏ†ë Ìò∏Ï∂ú
                const result = await callGeminiAPI(apiKey, text, title);
                
                if (result) {
                    currentAnalysisResult = result;
                    displayResults(result);
                } else {
                    showError('Î∂ÑÏÑù Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§. API ÌÇ§Î•º ÌôïÏù∏ÌïòÍ≥† Îã§Ïãú ÏãúÎèÑÌï¥Ï£ºÏÑ∏Ïöî.');
                }
            } catch (error) {
                console.error('Analysis error:', error);
                showError('Î∂ÑÏÑù Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§: ' + error.message);
            } finally {
                analysisInProgress = false;
                document.getElementById('analyzeBtn').disabled = false;
                document.getElementById('loading').style.display = 'none';
            }
        }
        
        // Î™®Îç∏Î≥Ñ ÏµúÏ†ÅÌôîÎêú ÏÑ§Ï†ï Î∞òÌôò
        function getModelConfig(modelName) {
            const configs = {
                'gemini-2.5-pro': {
                    temperature: 0.2,
                    topK: 40,
                    topP: 0.8,
                    maxOutputTokens: 4096,
                },
                'gemini-2.5-flash': {
                    temperature: 0.3,
                    topK: 40,
                    topP: 0.95,
                    maxOutputTokens: 2048,
                },
                'gemini-2.5-flash-lite': {
                    temperature: 0.4,
                    topK: 32,
                    topP: 0.9,
                    maxOutputTokens: 1024,
                },
                'gemini-2.0-flash': {
                    temperature: 0.25,
                    topK: 40,
                    topP: 0.9,
                    maxOutputTokens: 3072,
                }
            };
            return configs[modelName] || configs['gemini-2.5-flash'];
        }
        
        // Î™®Îç∏Î≥Ñ ÏµúÏ†ÅÌôîÎêú ÌîÑÎ°¨ÌîÑÌä∏ ÏÉùÏÑ±
        function generateOptimizedPrompt(modelName, text, title) {
            const basePrompt = `Please analyze the following English poem comprehensively:

Title: ${title}

Poem:
${text}

Please analyze from these aspects:
1. Rhetorical Devices: metaphor, simile, personification, hyperbole, etc.
2. Sound Devices: alliteration, rhyme, rhythm, meter, etc.
3. Themes & Symbols: major themes, symbols, motifs, etc.
4. Style & Tone: stylistic features, tone, mood, etc.
5. Structure & Form: poetic form, organization, rhyme scheme, etc.

Please provide specific examples and explanations for each analysis item.
Structure the analysis results in JSON format.

JSON format:
{
  "title": "poem title",
  "analysis": {
    "rhetorical_devices": [
      {
        "type": "device type",
        "text": "relevant passage",
        "explanation": "explanation"
      }
    ],
    "sound_devices": [...],
    "themes_symbols": [...],
    "style_tone": [...],
    "structure_form": [...]
  },
  "summary": "overall analysis summary"
}`;

            // Î™®Îç∏Î≥Ñ ÌäπÌôî ÌîÑÎ°¨ÌîÑÌä∏ Ï∂îÍ∞Ä
            const modelSpecificPrompts = {
                'gemini-2.5-pro': basePrompt + `\n\nAs Gemini 2.5 Pro, please provide deep literary analysis with advanced reasoning and comprehensive insights. Focus on complex literary relationships and nuanced interpretations.`,
                'gemini-2.5-flash': basePrompt + `\n\nAs Gemini 2.5 Flash, please provide efficient yet thorough analysis with clear explanations and practical insights.`,
                'gemini-2.5-flash-lite': basePrompt + `\n\nAs Gemini 2.5 Flash-Lite, please provide concise but accurate analysis focusing on the most important literary elements.`,
                'gemini-2.0-flash': basePrompt + `\n\nAs Gemini 2.0 Flash, please leverage next-generation capabilities to provide innovative analysis with enhanced understanding of literary nuances.`
            };
            
            return modelSpecificPrompts[modelName] || basePrompt;
        }

        async function callGeminiAPI(apiKey, text, title) {
            const selectedModel = document.getElementById('modelSelect').value;
            const prompt = generateOptimizedPrompt(selectedModel, text, title);
            const config = getModelConfig(selectedModel);

            try {
                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/${selectedModel}:generateContent?key=${apiKey}`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        contents: [{
                            parts: [{
                                text: prompt
                            }]
                        }],
                        generationConfig: config
                    })
                });
                
                if (!response.ok) {
                    const errorData = await response.json().catch(() => ({}));
                    let errorMessage = `API Ìò∏Ï∂ú Ïã§Ìå® (${response.status})`;
                    
                    if (response.status === 400) {
                        errorMessage = 'API ÌÇ§Í∞Ä Ïò¨Î∞îÎ•¥ÏßÄ ÏïäÍ±∞ÎÇò ÏöîÏ≤≠ ÌòïÏãùÏóê Î¨∏Ï†úÍ∞Ä ÏûàÏäµÎãàÎã§.';
                    } else if (response.status === 403) {
                        errorMessage = 'API ÌÇ§ Í∂åÌïúÏù¥ ÏóÜÍ±∞ÎÇò Ìï†ÎãπÎüâÏùÑ Ï¥àÍ≥ºÌñàÏäµÎãàÎã§.';
                    } else if (response.status === 429) {
                        errorMessage = 'API ÏöîÏ≤≠ ÌïúÎèÑÎ•º Ï¥àÍ≥ºÌñàÏäµÎãàÎã§. Ïû†Ïãú ÌõÑ Îã§Ïãú ÏãúÎèÑÌï¥Ï£ºÏÑ∏Ïöî.';
                    } else if (response.status >= 500) {
                        errorMessage = 'Google ÏÑúÎ≤ÑÏóê ÏùºÏãúÏ†ÅÏù∏ Î¨∏Ï†úÍ∞Ä ÏûàÏäµÎãàÎã§. Ïû†Ïãú ÌõÑ Îã§Ïãú ÏãúÎèÑÌï¥Ï£ºÏÑ∏Ïöî.';
                    }
                    
                    throw new Error(errorMessage);
                }
                
                const data = await response.json();
                console.log('API Response:', data); // ÎîîÎ≤ÑÍπÖÏö©
                
                // ÏïàÏ†ÑÌïú ÏùëÎãµ Ï≤òÎ¶¨
                if (data.candidates && data.candidates.length > 0) {
                    const candidate = data.candidates[0];
                    
                    // ÏïàÏ†Ñ Ï†ïÏ±Ö Ï≤¥ÌÅ¨
                    if (candidate.finishReason === 'SAFETY') {
                        throw new Error('ÏΩòÌÖêÏ∏†Í∞Ä ÏïàÏ†Ñ Ï†ïÏ±ÖÏóê ÏùòÌï¥ Ï∞®Îã®ÎêòÏóàÏäµÎãàÎã§. Îã§Î•∏ ÏãúÎ•º ÏãúÎèÑÌï¥Î≥¥ÏÑ∏Ïöî.');
                    }
                    
                    // ÏΩòÌÖêÏ∏† Ï∂îÏ∂ú
                    let content = '';
                    if (candidate.content && candidate.content.parts && candidate.content.parts.length > 0) {
                        content = candidate.content.parts[0].text;
                    } else if (candidate.text) {
                        content = candidate.text;
                    } else {
                        throw new Error('API ÏùëÎãµÏóêÏÑú ÌÖçÏä§Ìä∏ ÏΩòÌÖêÏ∏†Î•º Ï∞æÏùÑ Ïàò ÏóÜÏäµÎãàÎã§.');
                    }
                    
                    // JSON Ï∂îÏ∂ú ÏãúÎèÑ
                    try {
                        const jsonMatch = content.match(/\{[\s\S]*\}/);
                        if (jsonMatch) {
                            const jsonStr = jsonMatch[0];
                            return JSON.parse(jsonStr);
                        } else {
                            // JSONÏù¥ ÏóÜÏúºÎ©¥ ÌÖçÏä§Ìä∏ ÌååÏã±
                            return parseTextResponse(content, title);
                        }
                    } catch (e) {
                        console.warn('JSON ÌååÏã± Ïã§Ìå®, ÌÖçÏä§Ìä∏ ÌååÏã±ÏúºÎ°ú Ï†ÑÌôò:', e);
                        return parseTextResponse(content, title);
                    }
                } else if (data.error) {
                    throw new Error(`API Ïò§Î•ò: ${data.error.message || 'Unknown error'}`);
                } else {
                    console.error('Unexpected API response structure:', data);
                    throw new Error('API ÏùëÎãµ Íµ¨Ï°∞Í∞Ä ÏòàÏÉÅÍ≥º Îã§Î¶ÖÎãàÎã§. ÏΩòÏÜîÏùÑ ÌôïÏù∏Ìï¥Ï£ºÏÑ∏Ïöî.');
                }
            } catch (error) {
                console.error('API Ìò∏Ï∂ú ÏÉÅÏÑ∏ Ïò§Î•ò:', error);
                
                if (error.name === 'TypeError' && error.message.includes('fetch')) {
                    throw new Error('ÎÑ§Ìä∏ÏõåÌÅ¨ Ïó∞Í≤∞Ïóê Î¨∏Ï†úÍ∞Ä ÏûàÏäµÎãàÎã§. Ïù∏ÌÑ∞ÎÑ∑ Ïó∞Í≤∞ÏùÑ ÌôïÏù∏Ìï¥Ï£ºÏÑ∏Ïöî.');
                } else if (error.message.includes('API ÌÇ§')) {
                    throw new Error('API ÌÇ§Í∞Ä Ïò¨Î∞îÎ•¥ÏßÄ ÏïäÏäµÎãàÎã§. Google AI StudioÏóêÏÑú ÏÉàÎ°úÏö¥ ÌÇ§Î•º Î∞úÍ∏âÎ∞õÏïÑ Ï£ºÏÑ∏Ïöî.');
                } else if (error.message.includes('quota') || error.message.includes('limit')) {
                    throw new Error('API ÏÇ¨Ïö©Îüâ ÌïúÎèÑÎ•º Ï¥àÍ≥ºÌñàÏäµÎãàÎã§. Ïû†Ïãú ÌõÑ Îã§Ïãú ÏãúÎèÑÌïòÍ±∞ÎÇò Îã§Î•∏ Î™®Îç∏ÏùÑ ÏÑ†ÌÉùÌï¥Ï£ºÏÑ∏Ïöî.');
                }
                
                throw error;
            }
        }
        
        function parseTextResponse(content, title) {
            console.log('ÌÖçÏä§Ìä∏ ÌååÏã± ÏãúÏûë:', content.substring(0, 200) + '...');
            
            // ÌÖçÏä§Ìä∏ ÏùëÎãµÏùÑ Íµ¨Ï°∞ÌôîÎêú ÌòïÌÉúÎ°ú ÌååÏã±
            const analysis = {
                rhetorical_devices: [],
                sound_devices: [],
                themes_symbols: [],
                style_tone: [],
                structure_form: []
            };
            
            if (!content || typeof content !== 'string') {
                console.warn('Ïú†Ìö®ÌïòÏßÄ ÏïäÏùÄ ÏΩòÌÖêÏ∏†:', content);
                return {
                    title: title,
                    analysis: analysis,
                    summary: 'Î∂ÑÏÑù Í≤∞Í≥ºÎ•º ÌååÏã±Ìï† Ïàò ÏóÜÏäµÎãàÎã§.'
                };
            }
            
            // Í∞úÏÑ†Îêú ÌÖçÏä§Ìä∏ ÌååÏã± Î°úÏßÅ
            const lines = content.split('\n');
            let currentSection = '';
            let currentItem = null;
            
            for (const line of lines) {
                const trimmed = line.trim();
                
                if (!trimmed) continue;
                
                // ÏÑπÏÖò Ìó§Îçî Í∞êÏßÄ
                if (trimmed.match(/rhetorical|ÏàòÏÇ¨Î≤ï|figurative/i)) {
                    currentSection = 'rhetorical_devices';
                } else if (trimmed.match(/sound|ÏùåÏÑ±|alliteration|rhyme/i)) {
                    currentSection = 'sound_devices';
                } else if (trimmed.match(/theme|Ï£ºÏ†ú|symbol|ÏÉÅÏßï/i)) {
                    currentSection = 'themes_symbols';
                } else if (trimmed.match(/style|Î¨∏Ï≤¥|tone|Ïñ¥Ï°∞/i)) {
                    currentSection = 'style_tone';
                } else if (trimmed.match(/structure|Íµ¨Ï°∞|form|ÌòïÏãù/i)) {
                    currentSection = 'structure_form';
                }
                
                // Î∂ÑÏÑù Ìï≠Î™© Ï∂îÏ∂ú
                if (currentSection && trimmed) {
                    // Í∏∞Î≤ï Ïú†Ìòï Í∞êÏßÄ
                    const deviceMatch = trimmed.match(/(metaphor|simile|personification|alliteration|rhyme|symbol|theme)/i);
                    if (deviceMatch) {
                        const deviceType = deviceMatch[1];
                        const textMatch = trimmed.match(/"([^"]+)"/);
                        const quotedText = textMatch ? textMatch[1] : trimmed;
                        
                        analysis[currentSection].push({
                            type: deviceType,
                            text: quotedText,
                            explanation: trimmed
                        });
                    } else if (trimmed.includes('-') || trimmed.includes('‚Ä¢') || trimmed.includes('*')) {
                        // Î¶¨Ïä§Ìä∏ Ìï≠Î™© Ï≤òÎ¶¨
                        const cleanText = trimmed.replace(/^[-‚Ä¢*]\s*/, '');
                        if (cleanText.length > 10) {
                            analysis[currentSection].push({
                                type: 'Literary Device',
                                text: cleanText.substring(0, 50) + '...',
                                explanation: cleanText
                            });
                        }
                    }
                }
            }
            
            // Îπà ÏÑπÏÖòÏóê Í∏∞Î≥∏ Ìï≠Î™© Ï∂îÍ∞Ä
            Object.keys(analysis).forEach(key => {
                if (analysis[key].length === 0) {
                    analysis[key].push({
                        type: 'Analysis',
                        text: 'Various literary elements detected',
                        explanation: 'This poem contains multiple literary devices that contribute to its overall effect.'
                    });
                }
            });
            
            return {
                title: title,
                analysis: analysis,
                summary: content.length > 300 ? content.substring(0, 300) + '...' : content
            };
        }
        
        function simulateProgress() {
            const progressFill = document.getElementById('progressFill');
            const progressText = document.getElementById('progressText');
            const selectedModel = document.getElementById('modelSelect').value;
            
            // Î™®Îç∏Î≥Ñ ÏßÑÌñâ Îã®Í≥Ñ Î∞è ÏòàÏÉÅ ÏãúÍ∞Ñ
            const modelSteps = {
                'gemini-2.5-pro': [
                    { progress: 15, text: 'üß† Pro Î™®Îç∏Î°ú Ïã¨Ï∏µ Î∂ÑÏÑù ÏãúÏûë...' },
                    { progress: 30, text: 'üîç Í≥†Í∏â ÏàòÏÇ¨Î≤ï Ìå®ÌÑ¥ Î∂ÑÏÑù Ï§ë...' },
                    { progress: 50, text: 'üéµ Ï†ïÎ∞ÄÌïú Ïö¥Ïú® Íµ¨Ï°∞ Ìï¥ÏÑù Ï§ë...' },
                    { progress: 70, text: 'üîÆ Î≥µÌï©Ï†Å Ï£ºÏ†ú Í¥ÄÍ≥Ñ Î∂ÑÏÑù Ï§ë...' },
                    { progress: 85, text: '‚úçÔ∏è Î¨∏Ï≤¥Ï†Å ÎâòÏïôÏä§ Î∂ÑÏÑù Ï§ë...' },
                    { progress: 95, text: 'üìä Ï¢ÖÌï© Î≥¥Í≥†ÏÑú ÏÉùÏÑ± Ï§ë...' },
                    { progress: 100, text: '‚ú® Í≥†Í∏â Î∂ÑÏÑù ÏôÑÎ£å!' }
                ],
                'gemini-2.5-flash': [
                    { progress: 20, text: '‚ö° Flash Î™®Îç∏Î°ú Ìö®Ïú®Ï†Å Î∂ÑÏÑù Ï§ë...' },
                    { progress: 40, text: 'üé≠ ÏàòÏÇ¨Î≤ï ÌÉêÏßÄ Ï§ë...' },
                    { progress: 60, text: 'üéµ Ïö¥Ïú® Ìå®ÌÑ¥ Î∂ÑÏÑù Ï§ë...' },
                    { progress: 80, text: 'üîÆ Ï£ºÏ†ú Ìï¥ÏÑù Ï§ë...' },
                    { progress: 95, text: 'üìÑ Î≥¥Í≥†ÏÑú ÏÉùÏÑ± Ï§ë...' },
                    { progress: 100, text: 'üéâ Î∂ÑÏÑù ÏôÑÎ£å!' }
                ],
                'gemini-2.5-flash-lite': [
                    { progress: 25, text: 'üí® Lite Î™®Îç∏Î°ú Îπ†Î•∏ Î∂ÑÏÑù Ï§ë...' },
                    { progress: 50, text: 'üé≠ ÌïµÏã¨ ÏàòÏÇ¨Î≤ï ÏãùÎ≥Ñ Ï§ë...' },
                    { progress: 75, text: 'üîÆ Ï£ºÏöî Ï£ºÏ†ú ÌååÏïÖ Ï§ë...' },
                    { progress: 95, text: 'üìù Í∞ÑÍ≤∞Ìïú Î≥¥Í≥†ÏÑú ÏÉùÏÑ± Ï§ë...' },
                    { progress: 100, text: '‚ö° Îπ†Î•∏ Î∂ÑÏÑù ÏôÑÎ£å!' }
                ],
                'gemini-2.0-flash': [
                    { progress: 18, text: 'üöÄ Ï∞®ÏÑ∏ÎåÄ Î™®Îç∏Î°ú ÌòÅÏã†Ï†Å Î∂ÑÏÑù ÏãúÏûë...' },
                    { progress: 35, text: 'üé≠ Í≥†ÎèÑÌôîÎêú ÏàòÏÇ¨Î≤ï Î∂ÑÏÑù Ï§ë...' },
                    { progress: 55, text: 'üéµ Ï∞®ÏÑ∏ÎåÄ Ïö¥Ïú® Ìï¥ÏÑù Ï§ë...' },
                    { progress: 75, text: 'üîÆ ÍπäÏù¥ ÏûàÎäî ÏÉÅÏßï Î∂ÑÏÑù Ï§ë...' },
                    { progress: 90, text: 'üìä ÌòÅÏã†Ï†Å Î≥¥Í≥†ÏÑú ÏÉùÏÑ± Ï§ë...' },
                    { progress: 100, text: 'üåü Ï∞®ÏÑ∏ÎåÄ Î∂ÑÏÑù ÏôÑÎ£å!' }
                ]
            };
            
            const steps = modelSteps[selectedModel] || modelSteps['gemini-2.5-flash'];
            let currentStep = 0;
            
            const updateProgress = () => {
                if (currentStep < steps.length && analysisInProgress) {
                    const step = steps[currentStep];
                    progressFill.style.width = step.progress + '%';
                    progressText.textContent = step.text;
                    currentStep++;
                    
                    // Î™®Îç∏Î≥Ñ Îã§Î•∏ ÏßÑÌñâ ÏÜçÎèÑ
                    const delays = {
                        'gemini-2.5-pro': 2000 + Math.random() * 3000,      // Îçî ÎäêÎ¶º
                        'gemini-2.5-flash': 1000 + Math.random() * 2000,    // Î≥¥ÌÜµ
                        'gemini-2.5-flash-lite': 800 + Math.random() * 1500, // Îπ†Î¶Ñ
                        'gemini-2.0-flash': 1200 + Math.random() * 2500     // Ï§ëÍ∞Ñ
                    };
                    
                    const delay = delays[selectedModel] || delays['gemini-2.5-flash'];
                    setTimeout(updateProgress, delay);
                }
            };
            
            updateProgress();
        }
        
        function displayResults(result) {
            const analysis = result.analysis;
            const selectedModel = document.getElementById('modelSelect').value;
            
            // ÌÜµÍ≥Ñ Í≥ÑÏÇ∞
            const totalDevices = Object.values(analysis).reduce((sum, category) => sum + category.length, 0);
            const categoriesWithResults = Object.values(analysis).filter(category => category.length > 0).length;
            
            // Î™®Îç∏Î≥Ñ ÏïÑÏù¥ÏΩò
            const modelIcons = {
                'gemini-2.5-pro': 'üß†',
                'gemini-2.5-flash': '‚ö°',
                'gemini-2.5-flash-lite': 'üí®',
                'gemini-2.0-flash': 'üöÄ'
            };
            
            // ÌÜµÍ≥Ñ ÌëúÏãú
            document.getElementById('resultsStats').innerHTML = `
                <div class="stat-card">
                    <span class="stat-number">${totalDevices}</span>
                    <span class="stat-label">Î∞úÍ≤¨Îêú Í∏∞Î≤ï</span>
                </div>
                <div class="stat-card">
                    <span class="stat-number">${categoriesWithResults}</span>
                    <span class="stat-label">Î∂ÑÏÑù ÏòÅÏó≠</span>
                </div>
                <div class="stat-card">
                    <span class="stat-number">${document.getElementById('poemInput').value.split(' ').length}</span>
                    <span class="stat-label">Îã®Ïñ¥ Ïàò</span>
                </div>
                <div class="stat-card">
                    <span class="stat-number">${document.getElementById('poemInput').value.split('\n').length}</span>
                    <span class="stat-label">Ìñâ Ïàò</span>
                </div>
                <div class="stat-card">
                    <span class="stat-number">${modelIcons[selectedModel] || 'ü§ñ'}</span>
                    <span class="stat-label">${selectedModel.replace('gemini-', '').toUpperCase()}</span>
                </div>
            `;
            
            // ÎØ∏Î¶¨Î≥¥Í∏∞ ÏÉùÏÑ±
            let previewHtml = `<h3>${result.title}</h3><br>`;
            previewHtml += `<p><strong>Ï†ÑÏ≤¥ ÏöîÏïΩ:</strong> ${result.summary}</p><br>`;
            
            const categoryNames = {
                rhetorical_devices: 'üé≠ ÏàòÏÇ¨Î≤ï',
                sound_devices: 'üéµ ÏùåÏÑ± Í∏∞Î≤ï',
                themes_symbols: 'üîÆ Ï£ºÏ†úÏôÄ ÏÉÅÏßï',
                style_tone: '‚úçÔ∏è Î¨∏Ï≤¥ÏôÄ Ïñ¥Ï°∞',
                structure_form: 'üèóÔ∏è Íµ¨Ï°∞ÏôÄ ÌòïÏãù'
            };
            
            for (const [key, items] of Object.entries(analysis)) {
                if (items.length > 0) {
                    previewHtml += `<h4>${categoryNames[key]} (${items.length}Í∞ú)</h4>`;
                    items.slice(0, 3).forEach(item => {
                        previewHtml += `<p><strong>${item.type}:</strong> ${item.text}</p>`;
                        if (item.explanation && item.explanation !== item.text) {
                            previewHtml += `<p style="margin-left: 20px; color: #666;"><em>${item.explanation}</em></p>`;
                        }
                    });
                    if (items.length > 3) {
                        previewHtml += `<p><em>... Ïô∏ ${items.length - 3}Í∞ú Îçî</em></p>`;
                    }
                    previewHtml += '<br>';
                }
            }
            
            document.getElementById('previewContent').innerHTML = previewHtml;
            document.getElementById('results').style.display = 'block';
        }
        
        function generateHTMLReport(result) {
            const analysis = result.analysis;
            const poemText = document.getElementById('poemInput').value;
            const selectedModel = document.getElementById('modelSelect').value;
            const modelIcons = {
                'gemini-2.5-pro': 'üß†',
                'gemini-2.5-flash': '‚ö°',
                'gemini-2.5-flash-lite': 'üí®',
                'gemini-2.0-flash': 'üöÄ'
            };
            
            return `<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>${result.title} - Ïãú Î∂ÑÏÑù Î≥¥Í≥†ÏÑú</title>
    <style>
        body {
            font-family: 'Georgia', serif;
            line-height: 1.6;
            max-width: 800px;
            margin: 0 auto;
            padding: 40px 20px;
            color: #333;
        }
        .header {
            text-align: center;
            margin-bottom: 40px;
            padding-bottom: 20px;
            border-bottom: 3px solid #667eea;
        }
        .header h1 {
            color: #667eea;
            margin-bottom: 10px;
        }
        .poem-text {
            background: #f8f9fa;
            padding: 30px;
            border-radius: 10px;
            border-left: 5px solid #667eea;
            margin: 30px 0;
            font-style: italic;
            white-space: pre-line;
        }
        .analysis-section {
            margin: 40px 0;
        }
        .section-title {
            color: #495057;
            border-bottom: 2px solid #e9ecef;
            padding-bottom: 10px;
            margin-bottom: 20px;
            font-size: 1.3em;
        }
        .analysis-item {
            background: white;
            border: 1px solid #e9ecef;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 15px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .item-type {
            background: #667eea;
            color: white;
            padding: 5px 12px;
            border-radius: 15px;
            font-size: 0.9em;
            font-weight: bold;
            display: inline-block;
            margin-bottom: 10px;
        }
        .item-text {
            font-weight: bold;
            color: #495057;
            margin-bottom: 8px;
        }
        .item-explanation {
            color: #6c757d;
            font-style: italic;
        }
        .summary {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 30px;
            border-radius: 10px;
            margin-top: 40px;
        }
        .summary h2 {
            margin-bottom: 15px;
        }
        .footer {
            text-align: center;
            margin-top: 50px;
            padding-top: 20px;
            border-top: 1px solid #e9ecef;
            color: #6c757d;
            font-size: 0.9em;
        }
        @media print {
            body { font-size: 12pt; }
            .header { page-break-after: avoid; }
            .analysis-item { page-break-inside: avoid; }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>üìö Ïãú Î∂ÑÏÑù Î≥¥Í≥†ÏÑú</h1>
        <h2>${result.title}</h2>
        <p>ÏÉùÏÑ±Ïùº: ${new Date().toLocaleDateString('ko-KR')}</p>
        <p>Î∂ÑÏÑù Î™®Îç∏: ${modelIcons[selectedModel] || 'ü§ñ'} ${selectedModel.toUpperCase()}</p>
    </div>
    
    <div class="poem-text">
        <h3>üìú ÏõêÎ¨∏</h3>
        ${poemText}
    </div>
    
    ${Object.entries(analysis).map(([key, items]) => {
        if (items.length === 0) return '';
        
        const categoryNames = {
            rhetorical_devices: 'üé≠ ÏàòÏÇ¨Î≤ï Î∂ÑÏÑù',
            sound_devices: 'üéµ ÏùåÏÑ± Í∏∞Î≤ï Î∂ÑÏÑù',
            themes_symbols: 'üîÆ Ï£ºÏ†úÏôÄ ÏÉÅÏßï Î∂ÑÏÑù',
            style_tone: '‚úçÔ∏è Î¨∏Ï≤¥ÏôÄ Ïñ¥Ï°∞ Î∂ÑÏÑù',
            structure_form: 'üèóÔ∏è Íµ¨Ï°∞ÏôÄ ÌòïÏãù Î∂ÑÏÑù'
        };
        
        return `
        <div class="analysis-section">
            <h2 class="section-title">${categoryNames[key]}</h2>
            ${items.map(item => `
                <div class="analysis-item">
                    <div class="item-type">${item.type}</div>
                    <div class="item-text">"${item.text}"</div>
                    <div class="item-explanation">${item.explanation}</div>
                </div>
            `).join('')}
        </div>
        `;
    }).join('')}
    
    <div class="summary">
        <h2>üìä Ï¢ÖÌï© Î∂ÑÏÑù</h2>
        <p>${result.summary}</p>
    </div>
    
    <div class="footer">
        <p>ü§ñ AI Í∏∞Î∞ò Ïãú Î∂ÑÏÑù ÎèÑÍµ¨Î°ú ÏÉùÏÑ±Îê®</p>
        <p>üìö Poetry Analyzer - Powered by Google Gemini AI</p>
    </div>
</body>
</html>`;
        }
        
        function downloadReport() {
            if (!currentAnalysisResult) {
                showError('Îã§Ïö¥Î°úÎìúÌï† Î∂ÑÏÑù Í≤∞Í≥ºÍ∞Ä ÏóÜÏäµÎãàÎã§.');
                return;
            }
            
            const htmlContent = generateHTMLReport(currentAnalysisResult);
            const blob = new Blob([htmlContent], { type: 'text/html;charset=utf-8' });
            const url = URL.createObjectURL(blob);
            
            const link = document.createElement('a');
            link.href = url;
            link.download = `${currentAnalysisResult.title.replace(/[^a-zA-Z0-9Í∞Ä-Ìû£\s]/g, '_')}_Î∂ÑÏÑùÎ≥¥Í≥†ÏÑú.html`;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            URL.revokeObjectURL(url);
        }
    </script>
</body>
</html>